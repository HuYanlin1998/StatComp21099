<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yanlin Hu" />

<meta name="date" content="2021-12-20" />

<title>21099hw</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">21099hw</h1>
<h4 class="author">Yanlin Hu</h4>
<h4 class="date">2021-12-20</h4>



<div id="hw1" class="section level2">
<h2>HW1</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1-text" class="section level3">
<h3>Example 1 (text)</h3>
<p>哈哈哈</p>
</div>
<div id="example-2-figures" class="section level3">
<h3>Example 2 (figures)</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a>iris.summary &lt;-<span class="st"> </span><span class="kw">aggregate</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="kw">list</span>(iris<span class="op">$</span>Species), mean)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">names</span>(iris.summary)[<span class="dv">1</span>] &lt;-<span class="st"> &#39;Species&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">col =</span> Species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> iris.summary, <span class="dt">shape =</span> <span class="dv">15</span>, <span class="dt">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA7VBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYAujgzMzM6AAA6ADo6AGY6OmY6OpA6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmOjpmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQZgCQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2r5OSr5P+2ZgC225C22/+2///Ijk3I///bkDrb25Db/7bb/9vb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+vmG0vAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANLElEQVR4nO2dC3fbthXHZdez53iW19buOmdbnLWN22ROt1WdEq2zo0r25he//8cZLt4ASVyQAik+7v8cWwJI6RA/ARcgLsA7yUhBTbZ9AV0XAUJEgBARIEQECFEQ0PP7N/z15uTk5POPbVxO9xQEdHMiAH14Y2Uujez3TSebhBBSCND9X77lZJ5//MnKJUBKzz/+UzSxx9esifF3v2Vq57o6owCgmwtpg+7/9JNVi6gGSd2/+qSMNEjbIQIkBV3XycmFShKgAskadPvFp+z576qbJ0BGAOj+zx+hMv1ed2QECBEBQlStkKvVigAFkquVJkSACJAQAUJUrZBkg9pKNlD2KBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIETkWUVENQhRc4DMbSoBKkpaEx0EiADZIkCIYktFNoh6sWIRIEQECBEBQoSUKpkbY6CA0jnCCBABIkBkg4qUrswEiACNHZBaBvz4+uSLTyqTABnJvRrA6eZLlVm5kNJsDxCQ2qvx+M1HvthVqGohVcc/PEB6r8b9q0/Z419hHXCdvRocUO3r27pi9mrAQnIBCEQ1SMrs1TA1CFS5kEO1QWavxmY2KFGyFRoFiunmn99fbNKLDRwQVB0aB1URAUIUVSowzASovFRi7EOACFCRCBCiqFKRDUpRZgJEgAhQgQgQolAxnDVB/OgmXqDT01P5fyiA3FVl2XIzP+IpSPwnQASIAC3JBklVK2SyZANljxIBQkSbWRBRDULUhJFeib6LAJV08yspAkSACkWAEIWKQTYo61wvtphMJjtX5Zd79yJwMEJ9B7TYnWfZenK+EYSQeg7o6ZKjme1db0QhoN4Dmsp3dy/eTibA6elyMoFqBa/7oomprLtD1h4rVjYHEP8C8V2RgPTN+iq3BbP27XsVQKx1Taby2nfnT5f7Gfxli71reH04OwdAKoubo7vDaoRsQPyLUNnXramorn0jQGICqBogYaX3ZcEZgjX8vIyMMs521lHwl8cBAfD+AeIXLqsHK8GCN4LJdC3bActXWdmMo6wPSFq8/gECChqQtNc2IGPCH84QAxIEpL80GtDWbZBsSACIN7Gj+Xrnyj7Cm5g9ToprJgWAGFulCkZ6QyIVkiVXM4PCg/E0RprVF4ZEGWxupEUW//2rDhx73s0LGw0dGe/mwcJAny6oOd08ZK2RUTcGSNY+pKF1DJDSprcUZQoAutXRRpzAI6MFtNA2SHSF/FHkYvFvXOCRlduVbW6zOwaoyMCL5eNo4JGVJ53XIqCmFDbSogahgUd8QDov9dVuQaFu/v6leNQ/GnhkNDVoIW9adIbZwhKMq1HAZ5CPxyno5o15rgyolV7s12K1AsjsEkMDj4wFkGpiU5ES4UZiAo+MBhAfi2NTbqMGFCPnuleWn8cGtMq5fQ4ODpZyRuM0KSC/C+0UIMHDv8RVwVaEA5Dkwwn1DhCz0GooFH+zOi5AkVNtYwUEE7ZY5eFyrns1MhvE/T4IpIJi5AHVQdA0oFpOjSIjvag8YTYiQDA5OQ1/Il2Zmwe0Fu2B+zLMP50PDQabwncAzYTzdjCAHv4wzxb7rFxTeIEaxN6t965l/sNXV3i1cmYUoya0S4vhtK/yMttGOuTnSQHoqyv1wpgwFkCGpWS+YhgHKNpfVFYMzwKVldnu5oOewgSAoA2xH52P73auGCCoL0/fX8l83mSwftvUIGZ+okZCfQLEJFtUxo20rEEqH9Y2xDexjAPHfdc9ArQGhyH7E5bH2CCZDxnoXL/fzS9QQ1RajO7ZINWEWBvbAfeh7sVkPjO7n32NWJb8OAi+pxag7vViKVR9JN0ptQgIhojV78U6UIPamjCrdTc/JkDRkte84vfrtmFelft54FbeSp5a3Zd4r+/1+wAoanUHB6NdqjqnGBCfDDJJa1ZIv9ezRT0AhIgAISJAiJaa0LhsUD/XKDIYB566UoMIUJnGDKj6Xo1xAXq6nD5dnmMzZ851r2ptMZRPm/AePtF9QIBGTJjEAhJgVGcfC4j3W2Y+SCfbAuRPkgUnzXxAi/0q66T7CchXNKBsxukshlKD7o6vYQZaTJLd/e7r3blw9wAQMYcmD4m0OikACPbvzbApRee6O22D+PT88bV0+hyeKzcQAwIbm5gp8ediC3bbDbqbXzA0U+P0UfP10r0hfD4sz8zmFzS2bQA69dQYoLvj//AWJp0+yg0EgI6vBSmoZsYfhAJa1FuC11VAT9+/O7acPjxPNKmaNchdxGk2syR+InlrgNgPPs0sp49x94ANYi85GxQG5C4DNptZ8pFZPKusJ8x1iQ747bu4YhtJAJB9i59P1gMk92nKdqXcPYFerAogBakgKoLXr1suBcPn4CBTl7z0YPiAuB/RQZhLdmMknfHNnbqJZWozSy4yiwYkZAGSOS6gzGIBR3OA7Ez5DV6yTG3farhTQmozSy4yS6dq0FZnFAWWfGSWLtmg7U658i0sqSOzFANCPtsNQGwcpHfmm4aVOjJLfwHN9n45O9dP8DCbWTo9DmoREF9sf978tvBxAIq5fddGeik7NlCuD3MAlfLqAqBsAU3MHgcVSfNBJ4B0Nx/mYxNR6QqA/G9r1Eiv5XMeQho1oBilAKSHkf5nhwNoIxukh5H5z1a3Qe0BWsglxdPwJ0JEGkwWX0ybgNZ8Ieh+Fmekowvp3Uq2D8idwjCpyL0t1hrFqXxSWgWvRh8AbSh3KwKf70g7UNwiIOH2eXc0594cZj0++yOffz7+AeaVzbRZcNOPC4hXnnSAhD12pIphG2/vs6euU6g+IOH2+TdDAg0DJlXFho3DqTXxut77Jbjpx2pi5/JBishzP+MBKRJFgBQhVa28G5Fsabr82oCE20dO0cO0vPFgiBeDpXzTj7UdSvrNsCfH9ggQd/soJMLN6gI6FlUhtOnH6uZn0MM/Xdbeq9E9QNztg9ag8KafRh2HW7ZBwu2jQBgbpAEJ58/PwU0/jXtWt9rNQ7kVINZj/carQbIXC276aTzwiAco8bdXGwfV2fc87BpkST1ssqr6D6jNCbMoIaUyEMT9eg6Q+J1HC8iqJr75EYdUSyBABCgOkBzv6fy0gJpX4zZIjfd0flIb1Lx6vkaxeREgRAQIEQFC1BwgYZXN+Dmz7s7jAEXczTevxgAJMNYdRmbN70QBipkPal4ECBEBQkQ2CBH1YogIECIChCgA6P6lDBbRi8gsTakcECwBhoARWVRkFnGDbs+pCvPsGFp9pkrmj/YI0C2sjOZo0MgsyttnzzprPt7zSlROviPvGyCQWEiORmaRe0/kHhYhC1DBmfn3XVUQECyxzyIis4y1Bj2+vjCJUOCR5ShtEOvFbNuMAGo82SSEkMoBGT5oZJZxAoLBD7PNMZFZxgmoTMXFOHAfwrVcOvaIAIkO3uPjEiJABEiIACEqLgbZIK10ZSZABIgAFYgAITKX7T281bPKZUZaOzkGD8h7/K/Xr5d189pNRoAIEAEqlLlsskGFqlKqhMkGyh4lAoSo8c0sfRfVIEStAfJWSxMgL+mttydABIgAlakeILJBTScbKHuUCBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhitqrkfiB2wMBZPZq5AOPFBYj8YKgzgMyezXiHvqfeklZ5wGB/LARpXs1sszZqDEgxezVyAUeoRokpPZq5AOPFBZjbDbI7EVIHXhkIIDMXo3UgUcGAsjaq0HjoCoiQIgIECIChIgAISJAtVV6F9Lw0UZFgBARIEQECBEt4kREgBARIEQECBEBQpQMkPMYr5ye31sPtyj6qPIwFej+ZeCLG1cyQB9KCyiP3poppQKVH4XJ3pvgZxtVKkDuY7x8waRtUGbKOyc+I459vjmlAmQe41Wk+1f/CDSxLLNmdPPfPIwa5D7GK3f05RteE8oUqECe47t1Je3FSu2Q6zjKK2SfAP3t9qx0O4AevwsD+nBReshzW7auVIDcx3jl9CHYxIIWfig1yHmMV07MjgTKGK4gt8Fvblo0kkZEgBARIEQECBEBQkSAEKUAtJiE4yvKIKY8HnlI//1XIN7ptpQA0ALCAIcCIEcC4kFRBwgIwt1mwRDaowc0NW95VOm7F28nE+AFgdwhmLAHSJ/2TgR6h3i5745+Zokp/ygSjbtdJWhia4AA4tHYedDx3Tm8FyHsd+ceIHMag8gOP5xN2aniNJW3+VWlUpJeDKw0K/R6l4dUPudR2Vlx/weNjr16gPzTeHqhAJ1n3Wpnqbr5h7O9a+A04e3kSgQph8rF+jcPkHMa+7fgrfForm3QIAHpkmaygAzQw9nOVUENck4bASBZHGgrcjAk2snRfA0lX+dqkD5NwuBNbL07WEDZDAoMlvfpkhEBINJIA4m7wxwgfZqEoYw0NMpBAhJGZZrpkOW8r2ZGO5ux5N+YNX5xBXDgKD9RnyZhQDf/llWj2WR/mIB81SngunycuV11ABC0RD426qQ6AEgNo7opmu5ARIAQESBEBAgRAUJEgBARIET/B3eH/PQbdGAdAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="example-3-tables" class="section level3">
<h3>Example 3 (tables)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb4-2"><a href="#cb4-2"></a>data&lt;-<span class="kw">head</span>(iris)</span>
<span id="cb4-3"><a href="#cb4-3"></a>data <span class="op">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw">kbl</span>(<span class="dt">caption =</span> <span class="st">&quot;table of iris&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">kable_classic</span>(<span class="dt">full_width =</span> F, <span class="dt">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
table of iris
</caption>
<thead>
<tr>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
1.7
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw2" class="section level2">
<h2>Hw2</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4 3.11, and 3.20</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.4</h3>
<p>这个一看就比较适合用Inverse transformation method来做,我们先求其分布函数: <span class="math inline">\(F(x)=\int_{0}^{x}f(t)dt=\int_{0}^{x}\frac{t}{\sigma^2}e^{-\frac{t^2}{2\sigma^2}}dt=\int_{0}^{x}\frac{1}{\sigma^2}e^{-\frac{t^2}{2\sigma^2}}d(\frac{t^2}{2})=\int_{0}^{\frac{x^2}{2}}\frac{1}{\sigma^2}e^{-\frac{u}{\sigma^2}}du=1-e^{-\frac{x^2}{2\sigma^2}}\)</span>,然后求逆: <span class="math inline">\(F(x)=t \Rightarrow 1-e^{-\frac{x^2}{2\sigma^2}}=t \Rightarrow x=\sigma\sqrt{-2ln(1-t)}\)</span> 下面生成几组不同的Rayleigh(<span class="math inline">\(\sigma\)</span>) samples</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb5-3"><a href="#cb5-3"></a>sigma=<span class="dv">1</span>   <span class="co"># sigma=1</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>x=sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)<span class="op">/</span><span class="dv">10</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>}))</span>
<span id="cb5-6"><a href="#cb5-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">.01</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb6-3"><a href="#cb6-3"></a>sigma=<span class="dv">2</span>   <span class="co"># sigma=2</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>x=sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb6-5"><a href="#cb6-5"></a>ran&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(x)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>(ran<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">8</span>}))</span>
<span id="cb6-7"><a href="#cb6-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, ran, <span class="fl">.01</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb7-3"><a href="#cb7-3"></a>sigma=<span class="fl">0.5</span>   <span class="co"># sigma=0.5</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>x=sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb7-5"><a href="#cb7-5"></a>ran&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(x)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>(ran<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">4</span><span class="op">*</span>x<span class="op">*</span>e<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>}))</span>
<span id="cb7-7"><a href="#cb7-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, ran, <span class="fl">.01</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">lines</span>(y,(y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.11</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>p1&lt;-<span class="fl">0.75</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>p2&lt;-<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb8-3"><a href="#cb8-3"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb8-5"><a href="#cb8-5"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>p1){</span>
<span id="cb8-10"><a href="#cb8-10"></a>    X[i]&lt;-X1[i]</span>
<span id="cb8-11"><a href="#cb8-11"></a>  }</span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="cf">else</span>{X[i]&lt;-X2[i]}</span>
<span id="cb8-13"><a href="#cb8-13"></a>}</span>
<span id="cb8-14"><a href="#cb8-14"></a>ran1&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">1</span>])</span>
<span id="cb8-15"><a href="#cb8-15"></a>ran2&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="kw">hist</span>(X,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>((ran1<span class="op">*</span><span class="dv">10</span>)<span class="op">:</span>(ran2<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(p1<span class="op">==</span><span class="fl">0.75</span>))</span>
<span id="cb8-17"><a href="#cb8-17"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(ran1, ran2, <span class="fl">.01</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>p2<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p1&lt;-<span class="fl">0.5</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>p2&lt;-<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb9-3"><a href="#cb9-3"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb9-5"><a href="#cb9-5"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a>X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>p1){</span>
<span id="cb9-10"><a href="#cb9-10"></a>    X[i]&lt;-X1[i]</span>
<span id="cb9-11"><a href="#cb9-11"></a>  }</span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="cf">else</span>{X[i]&lt;-X2[i]}</span>
<span id="cb9-13"><a href="#cb9-13"></a>}</span>
<span id="cb9-14"><a href="#cb9-14"></a>ran1&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">1</span>])</span>
<span id="cb9-15"><a href="#cb9-15"></a>ran2&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="kw">hist</span>(X,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>((ran1<span class="op">*</span><span class="dv">10</span>)<span class="op">:</span>(ran2<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(p1<span class="op">==</span><span class="fl">0.5</span>))</span>
<span id="cb9-17"><a href="#cb9-17"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(ran1, ran2, <span class="fl">.01</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>p2<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>p1&lt;-<span class="fl">0.25</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>p2&lt;-<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb10-3"><a href="#cb10-3"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb10-5"><a href="#cb10-5"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a>X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>p1){</span>
<span id="cb10-10"><a href="#cb10-10"></a>    X[i]&lt;-X1[i]</span>
<span id="cb10-11"><a href="#cb10-11"></a>  }</span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="cf">else</span>{X[i]&lt;-X2[i]}</span>
<span id="cb10-13"><a href="#cb10-13"></a>}</span>
<span id="cb10-14"><a href="#cb10-14"></a>ran1&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">1</span>])</span>
<span id="cb10-15"><a href="#cb10-15"></a>ran2&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="kw">hist</span>(X,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>((ran1<span class="op">*</span><span class="dv">10</span>)<span class="op">:</span>(ran2<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(p1<span class="op">==</span><span class="fl">0.25</span>))</span>
<span id="cb10-17"><a href="#cb10-17"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(ran1, ran2, <span class="fl">.01</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>p2<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmtttmtv+QOgCQOjqQZgCQZjqQkGaQttuQ2/+2ZgC2Zjq2kDq2kGa22/+2/7a2/9u2///bkDrbtpDb2//b/7bb////tmb/25D/27b//7b//9v////qgD+kAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJe0lEQVR4nO2di5bbJhRFmWTi9DmTPtK4TRulTRO1HXls/f/PVaCnbaEjGS5g+ey1knkKpD1wAYGQKskkKvYJpA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECApQfvHd5afHP7aqLu3T93Xzz8qdfed+TpXBtuRrqQkaP+D9TIzI+FV++VuY75++aX70S0I+mdjvcxCvfxUPnf+Dlv1S1WKtupBf37/NH6QH5IRdPhVvfzdJii7+1DqctMUof3jq+5D87kYcQVlLz5/VOrrT9Wn+zdvnwqLoKaUnBYW42a3eRA9xdiCftLxw5SPUtekcUFtKclefBl+u9BVrFBvq4D97SepU4wsSN39UR4+ttF3maDdRheophFrHXsnsiBzXYdtc+G9oKZpahquUUG7jTk4U98/DRx7J3YVM1ecN3//JSUo1w1bR+fYO1ch6DxIVw39ccDOVipoXhU7bea1n6bt2j+ONnD+iB2kq3qCg/RpR7E6rvvFTFUjjudOmHdil6CvdDFpq4dV0GCooatjM9IwB+4fzWdi3enYMejz+6oT016cXdDhz3awqgUVqhdUPr/vxq0SxBYkFFr9QUEACgJQECCZ2x2pQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAyQYdtPyd+IywSlLeLTAqx1SbJsUTQYdtpyWVXbyfEEkGDRymKm6lkLEGAhTGoKUKMQRaa9W5yC97Sg/0gAAUBLhBUCD4ZkR7LBGVKPey+eZp4dlIepfS/YCV/UUZZFZzrRe8Rm3kjKFxoWNxR3L3WgiJ2FJMWpHs/h39LliALeVtualWDVDq8nZiVJgYFym3hX6J5bsn+yEA4QaEitec8wghSdRWjoPEsrkJQbmnFgghSVyAoUHKjWRg9qgwUhK5ckLyiaxRUpisIzmoEFhQgDHme1bhtQTPuSUufb9PGJypoxqyGvCCVsKAkSlDKgmbMaoQT1H4mPSjzPKsRUlDZCZLM9sr6QX2Qvi5Boe4HqRFB6hoESSV3lvy5oJKChslTEEiegkDyI4LaXpFUlkknd5Z8REFVF8fDRnIrFlTvSOi67CdGDApZxZwdrV1QrchhWllWkIotSO8N9s5pyz2xM+3mU/v/j1SJ9eH7dPVAtDbjsDIhiKCREiRXiAatmI9VUXEESdayXtCbZrtQp4UtsoJsQTqoINuc6cLkfDMeecIJ6vZOTbWZt0We8CXIU3K+mRQUJEi7pSJ+w2xcy1G1k8n8WgaruAQJFaI60f3jQ3s/3u1hubUKmke9MrGYkhinFUtKkJkytC4kX7Mgffn55IM8+jcaNcFnVhMQlN0/6U3jM/ttMy1otzGCgs/Nxxeki4Ze3jsx1IhbgixahiN8kYzbT/SV692LJ4YadUP3qjxfSH6enG9QKyYvqKpb+hUM4GVLlSOzp7xtPLJmQebaD1u3O/eLz3Fu/3eWIAlDsXvSc//uFIR+b05PWlaQl305nATZLvCo0YonCG/A3w3X7BpXLMjacg/AL6lataAZz+nCRk5IkEpA0LwG3vIo3eU3zGYKSiFI2x8jvCi52Qdci6BIN8yuR1Ck5E4F9f/Ovo8EXVDBZ53gRXh74tAq6Pz70QVVlez+KXNbIbRmQcXdh1yP5sNOHI6KOBM0q5kXFqSfVNG3wQJPPc8QpI4sRGzF3hlBk4sX/D9xeD2C2hKUTdy1F3jiEAtSiQhqYlA+0V2UeF7MIqi/9nQE1V3FqVVUEk8cQkGnkTiiIEiMEnRqJmlBEk8cXo+geiwG1rf6f+LQbxUTMNQm2bxeOndca+8oqLtpkpygog3OzdTy0lT6S1t61HF/p69YFlWRBA3ulk3Mzc9Obu4v15fVfXVUxdS4hUiCBiOwgEONI0FNkHWLQQKTq60gTztFXyxIKR9BeqWC2uA1JmhhM79SQWUdPDyUIP+GkhCkjqpZmoL6hjWSoGGNSk9QnOQGVaycawEK8m0oAUHKpyDvRSg9QS5DjbLsAlqUK/Kc3MCHxxJEQTcpqMVRkGoF+bMUXdBCC1hQSUE3JMjSL3QU5LU75Cehvh8+/wgZQSpNQcuTU0qmivUfQl+Rwd/U8zoF+Zl67lt0MUEeO0MRJg6HV7EuQZ6mnp0sJC3oekqQiUF+LEWYej62IyjISxO9LA0vU89hBKkogrwkFyAGlc1fINAVeU7uuI33K0hFFuSloygp6PhDhCDt3lF0tJC0oIua+fYszelONu7eBTXZNZleiHhHsRPUtF4LL9BN0DDHCwlZgkDjLiKo7DK9ED8dxZOSrJJGUBDf9UzOoCDAhYLcFupdEyIlKG4QPsfpWnxJmZ3o1A/DHwihIIDnweqMRNcsCA9WZyS6YkEzhhozEl2xoNlrYW9VEEsQAs9qzEh0zYLmDlZvV9ANQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBSgqxboZnb2qM3S4qJ/a/sR4Hsyt1GOb1hV0hQYbsjcthWEvKxU9Yb0BQWQ/ajQHZlUf0AvOlhGhlBZlPP0Z/U2++MTMzWtyste89Yj0LZ1am6zAPLCMrvf5u8pzZSUoADy1Eou91r1/fuiQiqTmtqO8bR/fPrS5mcDLDtuj+RXfHi70e31zZKCNLlelLQ2C3tunhYC4nlKJRdruc4nd6mIiEIbehZ2GL0pKDRo1B2+R0slwABQaayTAgaLwmoilknUiazq2PaZRuz1fgVZF7HnjeLTk5PqnlXu2WjPRCk7dvz2bIz1MJdQnXwjqJts9jJZt56FMqungxOrIoZbGe829hKwlRH0X4UyM4EqMGM8HJCC2oqxJiI3D7UmDhqOrv6pZ6pNfOrgoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARIW9BuU8+5o8UdgqQtqFk2BRd3CJK4ILNw02mNoSupC9KLwKNud5W6oKp6/eywwtCd5AU5vzzYkeQFHbZuLxV0JXlB2f1/Ls+iOJO6oKLqAYG9ZmRJXNBuo0tPNvGAgjRpCzpsTfzZP8bbPDZpQVWArlt463Ma8iQtKAUoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA/2tZ9TFR17DuAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>p1&lt;-<span class="fl">0.1</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>p2&lt;-<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb11-3"><a href="#cb11-3"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb11-5"><a href="#cb11-5"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>p1){</span>
<span id="cb11-10"><a href="#cb11-10"></a>    X[i]&lt;-X1[i]</span>
<span id="cb11-11"><a href="#cb11-11"></a>  }</span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="cf">else</span>{X[i]&lt;-X2[i]}</span>
<span id="cb11-13"><a href="#cb11-13"></a>}</span>
<span id="cb11-14"><a href="#cb11-14"></a>ran1&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">1</span>])</span>
<span id="cb11-15"><a href="#cb11-15"></a>ran2&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="kw">hist</span>(X,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>((ran1<span class="op">*</span><span class="dv">10</span>)<span class="op">:</span>(ran2<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(p1<span class="op">==</span><span class="fl">0.1</span>))</span>
<span id="cb11-17"><a href="#cb11-17"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(ran1, ran2, <span class="fl">.01</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>p2<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>p1&lt;-<span class="fl">0.9</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>p2&lt;-<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb12-3"><a href="#cb12-3"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5"></a>X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>X&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>p1){</span>
<span id="cb12-10"><a href="#cb12-10"></a>    X[i]&lt;-X1[i]</span>
<span id="cb12-11"><a href="#cb12-11"></a>  }</span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="cf">else</span>{X[i]&lt;-X2[i]}</span>
<span id="cb12-13"><a href="#cb12-13"></a>}</span>
<span id="cb12-14"><a href="#cb12-14"></a>ran1&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">1</span>])</span>
<span id="cb12-15"><a href="#cb12-15"></a>ran2&lt;-<span class="kw">floor</span>(<span class="kw">range</span>(X)[<span class="dv">2</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="kw">hist</span>(X,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="kw">c</span>((ran1<span class="op">*</span><span class="dv">10</span>)<span class="op">:</span>(ran2<span class="op">*</span><span class="dv">10</span>))<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(p1<span class="op">==</span><span class="fl">0.9</span>))</span>
<span id="cb12-17"><a href="#cb12-17"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(ran1, ran2, <span class="fl">.01</span>)</span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="kw">lines</span>(y,p1<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>p2<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dv">3</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(p_1\)</span>太大或者太小都没有双峰出现,<span class="math inline">\(p_1=p_2\)</span>的时候双峰最明显.</p>
</div>
<div id="section-2" class="section level3">
<h3>3.20</h3>
<p>我们先求一下<span class="math inline">\(X(t)\)</span>的理论期望和方差: <span class="math inline">\(E(X_t)=E[E(X_t|N_t)]=E[E(\sum_{i=1}^{N_t}Y_i|N_t)]=E[N_tE(Y)]=E(N_t)E(Y)=\lambda t E(Y)\)</span>, 这是由于<span class="math inline">\(N_t\)</span>服从参数为<span class="math inline">\(\lambda t\)</span>的泊松分布. <span class="math inline">\(E(X_t^2)=E[E(X_t^2|N_t)]=E[E(\sum_{i,j=1}^{N_t}Y_iY_j|N_t)]=E[\sum_{i,j=1}^{N_t}E(Y_iY_j)]=E[N_tE(Y^2)+N_t(N_t-1)E(Y)^2]=\lambda tE(Y^2)+\lambda^2t^2E(Y)^2\)</span>, 所以<span class="math inline">\(Var(X_t)=E(X_t^2)-E(X_t)^2=\lambda t E(Y^2)\)</span>. 设gamma分布的形状参数为<span class="math inline">\(\alpha\)</span>,尺度参数为<span class="math inline">\(\gamma\)</span>,则其期望为<span class="math inline">\(\alpha\gamma\)</span>,方差为<span class="math inline">\(\alpha \gamma^2\)</span>,二阶矩为<span class="math inline">\((\alpha^2+\alpha)\gamma^2\)</span></p>
<p>我们下面写一个函数，可以用来生成任意参数任意时刻的任意数量的这个时刻的随机数，并计算样本均值和方差，和理论值做比较.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>gam&lt;-<span class="cf">function</span>(<span class="dt">lam=</span><span class="dv">1</span>,<span class="dt">alfa=</span><span class="dv">1</span>,<span class="dt">gamm=</span><span class="dv">1</span>,<span class="dt">t=</span><span class="dv">10</span>,<span class="dt">n=</span><span class="dv">1000</span>){</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="co">#lam is poisson(lam) parameter,alfa is shape parameter,gamm is scale parameter,n is sample size,</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="co">#t is time</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  Xt&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb13-5"><a href="#cb13-5"></a>  Nt&lt;-<span class="kw">rpois</span>(n,lam<span class="op">*</span>t)</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="cf">if</span>(Nt[i]<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb13-8"><a href="#cb13-8"></a>      Xt[i]&lt;-<span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>    }</span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="cf">else</span>{Xt[i]&lt;-<span class="kw">sum</span>(<span class="kw">rgamma</span>(Nt[i],<span class="dt">shape=</span>alfa,<span class="dt">scale=</span>gamm))}</span>
<span id="cb13-11"><a href="#cb13-11"></a>  }</span>
<span id="cb13-12"><a href="#cb13-12"></a>  bar&lt;-<span class="kw">mean</span>(Xt)</span>
<span id="cb13-13"><a href="#cb13-13"></a>  fangcha&lt;-<span class="kw">var</span>(Xt)</span>
<span id="cb13-14"><a href="#cb13-14"></a>  bar_the&lt;-lam<span class="op">*</span>t<span class="op">*</span>alfa<span class="op">*</span>gamm</span>
<span id="cb13-15"><a href="#cb13-15"></a>  fangcha_the&lt;-lam<span class="op">*</span>t<span class="op">*</span>(alfa<span class="op">^</span><span class="dv">2</span><span class="op">+</span>alfa)<span class="op">*</span>gamm<span class="op">^</span><span class="dv">2</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>  <span class="kw">cat</span>(<span class="st">&quot;sample mean at time t=&quot;</span>,t,<span class="st">&quot;is&quot;</span>,bar,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a>  <span class="kw">cat</span>(<span class="st">&quot;sample variance at time t=&quot;</span>,t,<span class="st">&quot;is&quot;</span>,fangcha,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18"></a>  <span class="kw">cat</span>(<span class="st">&quot;real mean at time t=&quot;</span>,t,<span class="st">&quot;is&quot;</span>,bar_the,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-19"><a href="#cb13-19"></a>  <span class="kw">cat</span>(<span class="st">&quot;real variance at time t=&quot;</span>,t,<span class="st">&quot;is&quot;</span>,fangcha_the,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-20"><a href="#cb13-20"></a>}  </span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="kw">gam</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## sample mean at time t= 10 is 10.08689 
## sample variance at time t= 10 is 20.31026 
## real mean at time t= 10 is 10 
## real variance at time t= 10 is 20</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">gam</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## sample mean at time t= 10 is 20.34305 
## sample variance at time t= 10 is 37.66015 
## real mean at time t= 10 is 20 
## real variance at time t= 10 is 40</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">gam</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## sample mean at time t= 10 is 58.67243 
## sample variance at time t= 10 is 486.9462 
## real mean at time t= 10 is 60 
## real variance at time t= 10 is 540</code></pre>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4 5.9 5.13 and 5.14</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level3">
<h3>5.4</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>pbeta1&lt;-<span class="cf">function</span>(<span class="dt">x=</span><span class="fl">0.5</span>,<span class="dt">a=</span><span class="dv">3</span>,<span class="dt">b=</span><span class="dv">3</span>,<span class="dt">n=</span><span class="dv">1000</span>){</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="co">#a,b,are two shape parameters,n is sample size, x is in (0,1),this function return the value of cdf of beta(a,b) at x</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  beta&lt;-<span class="kw">beta</span>(a,b)</span>
<span id="cb19-4"><a href="#cb19-4"></a>  u&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb19-5"><a href="#cb19-5"></a>  Fx&lt;-(x<span class="op">/</span>beta)<span class="op">*</span><span class="kw">mean</span>(u<span class="op">^</span>(a<span class="dv">-1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="kw">return</span>(Fx)</span>
<span id="cb19-7"><a href="#cb19-7"></a>}</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co"># next we Compare the estimates with the values returned by the pbeta function in R</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 5.879108e-05</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.2</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.001080113</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.0001711743</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.4</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.004652033</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.01510499</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.6</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.6</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.007093251</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.7</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.004959466</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.8</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.8</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.005563928</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">abs</span>(<span class="kw">pbeta1</span>(<span class="fl">0.9</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3000</span>)<span class="op">-</span><span class="kw">pbeta</span>(<span class="fl">0.9</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.004091717</code></pre>
</div>
<div id="section-4" class="section level3">
<h3>5.9</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>rRayleigh&lt;-<span class="cf">function</span>(<span class="dt">sigma=</span><span class="dv">1</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>,<span class="dt">m=</span><span class="dv">3000</span>){</span>
<span id="cb37-2"><a href="#cb37-2"></a>  u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb37-3"><a href="#cb37-3"></a>  v&lt;-<span class="kw">runif</span>(<span class="dv">2</span><span class="op">*</span>m)</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="cf">if</span>(antithetic<span class="op">==</span><span class="ot">TRUE</span>){</span>
<span id="cb37-5"><a href="#cb37-5"></a>    x&lt;-(sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">+</span>sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u)))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  } <span class="cf">else</span>{</span>
<span id="cb37-7"><a href="#cb37-7"></a>    x&lt;-(sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>v[<span class="dv">1</span><span class="op">:</span>m]))<span class="op">+</span>sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>v[(m<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="dv">2</span><span class="op">*</span>m)])))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>  }</span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="kw">return</span>(x)</span>
<span id="cb37-10"><a href="#cb37-10"></a>}</span>
<span id="cb37-11"><a href="#cb37-11"></a></span>
<span id="cb37-12"><a href="#cb37-12"></a></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="kw">var</span>(<span class="kw">rRayleigh</span>())</span></code></pre></div>
<pre><code>## [1] 0.01167365</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">var</span>(<span class="kw">rRayleigh</span>(<span class="dt">antithetic=</span><span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## [1] 0.2062325</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">abs</span>(<span class="kw">var</span>(<span class="kw">rRayleigh</span>(<span class="dt">antithetic=</span><span class="ot">FALSE</span>))<span class="op">-</span><span class="kw">var</span>(<span class="kw">rRayleigh</span>()))<span class="op">/</span><span class="kw">var</span>(<span class="kw">rRayleigh</span>(<span class="dt">antithetic=</span><span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## [1] 0.9222505</code></pre>
</div>
<div id="section-5" class="section level3">
<h3>5.13</h3>
<p>为了使Importance function和g比较close,我们考虑指数阶前面加个多项式的形式,令<span class="math inline">\(f_1(x)=c_1xe^{-\frac{x^2}{2}},f_2(x)=c_2x^3e^{-\frac{x^2}{2}}\)</span>,其中<span class="math inline">\(c_1\)</span>和<span class="math inline">\(c_2\)</span>待定,使其为<span class="math inline">\((1,+\infty)\)</span>上的密度,下面我们求这两个常数. <span class="math inline">\(\int_1^{+\infty}xe^{-\frac{x^2}{2}}dx=\int_{\frac 1 2}^{+\infty}e^{-u}du=\frac 1 {\sqrt{e}}\)</span>,故<span class="math inline">\(c_1=\sqrt{e}\)</span>. <span class="math inline">\(\int_1^{+\infty}x^3e^{-\frac{x^2}{2}}dx=2\int_{1}^{+\infty}\frac{x^2} 2e^{-\frac{x^2}{2}}d(\frac{x^2} 2)=2\int_{\frac 1 2}^{+\infty}ue^{-u}du=-2(u+1)e^{-u}|_{\frac 1 2}^{+\infty}=\frac 3{\sqrt{e}}\)</span>,故<span class="math inline">\(c_2=\frac{\sqrt{e}} 3\)</span>.故 <span class="math display">\[ f_1(x)=\sqrt{e}xe^{-\frac{x^2}{2}},f_2(x)=\frac{\sqrt{e}} 3x^3e^{-\frac{x^2}{2}}\]</span>. 下面我们计算各自estimator的方差,注意到不管取什么密度,<span class="math inline">\(E(\frac{g(X)}{f(X)})=\int g(x)dx\)</span>,所以只要比较其二阶矩即可,下面计算之.</p>
<p><span class="math display">\[E(\frac{g^2(X)}{f_1^2(X)})=\int_1^{+\infty}\frac{g^2(x)}{f_1(x)}dx=\frac 1{2\pi\sqrt{e}}\int_1^{+\infty}x^3e^{-\frac{x^2}{2}}dx=\frac 3 {2\pi e}\]</span> <span class="math display">\[E(\frac{g^2(X)}{f_2^2(X)})=\int_1^{+\infty}\frac{g^2(x)}{f_2(x)}dx=\frac 3{2\pi\sqrt{e}}\int_1^{+\infty}xe^{-\frac{x^2}{2}}dx=\frac 3 {2\pi e}\]</span></p>
<p>发现他们的方差是一样的.</p>
</div>
<div id="section-6" class="section level3">
<h3>5.14</h3>
<p>由上一题知道,用<span class="math inline">\(f_1,f_2\)</span>的方差是一样的,但是<span class="math inline">\(f_2\)</span>算不出来分布函数的反函数,不好抽样,所以我们用<span class="math inline">\(f_1\)</span>.</p>
<p>分布函数<span class="math inline">\(F_1(t)=\int_1^tf_1(x)dx=\sqrt{}e\int_1^txe^{-\frac{x^2}{2}}dx=\sqrt{e}(e^{-\frac 1 2}-e^{-\frac{t^2}{2}})=1-e^{-\frac{1-t^2}{2}}\)</span>,易求得<span class="math inline">\(F_1^{-1}(u)=\sqrt{1-2ln(1-u)}\)</span>,下面用程序模拟计算一下这个积分的值.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>Important1&lt;-<span class="cf">function</span>(<span class="dt">n=</span><span class="dv">3000</span>){</span>
<span id="cb43-2"><a href="#cb43-2"></a>  u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb43-3"><a href="#cb43-3"></a>  x&lt;-<span class="kw">sqrt</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(u))</span>
<span id="cb43-4"><a href="#cb43-4"></a>  theta&lt;-<span class="kw">mean</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">*</span>pi)</span>
<span id="cb43-5"><a href="#cb43-5"></a>  <span class="kw">return</span>(theta)</span>
<span id="cb43-6"><a href="#cb43-6"></a>}</span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="kw">Important1</span>()</span></code></pre></div>
<pre><code>## [1] 0.4013569</code></pre>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>(1)Exercises 6.5 and 6.A</p>
<p>(2)If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis testing</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>6.5</h3>
<p>The t-interval is more robust to departures from normality than the interval for variance <span class="math inline">\(\textbf{TRUELY}\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>quant&lt;-<span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>num&lt;-<span class="dv">0</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb45-5"><a href="#cb45-5"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb45-6"><a href="#cb45-6"></a>  m&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb45-7"><a href="#cb45-7"></a>  se&lt;-<span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="cf">if</span>((m<span class="op">-</span>quant<span class="op">*</span>se<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&lt;</span><span class="dv">2</span>)<span class="op">&amp;</span>(m<span class="op">+</span>quant<span class="op">*</span>se<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&gt;</span><span class="dv">2</span>)){</span>
<span id="cb45-9"><a href="#cb45-9"></a>    num&lt;-num<span class="op">+</span><span class="dv">1</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>  }</span>
<span id="cb45-11"><a href="#cb45-11"></a>}</span>
<span id="cb45-12"><a href="#cb45-12"></a>mean_rate_chisq&lt;-num<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>mean_rate_chisq</span></code></pre></div>
<pre><code>## [1] 0.915</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>num&lt;-<span class="dv">0</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb47-3"><a href="#cb47-3"></a>  x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb47-4"><a href="#cb47-4"></a>  m&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb47-5"><a href="#cb47-5"></a>  se&lt;-<span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="cf">if</span>((m<span class="op">-</span>quant<span class="op">*</span>se<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(m<span class="op">+</span>quant<span class="op">*</span>se<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&gt;</span><span class="dv">0</span>)){</span>
<span id="cb47-7"><a href="#cb47-7"></a>    num&lt;-num<span class="op">+</span><span class="dv">1</span></span>
<span id="cb47-8"><a href="#cb47-8"></a>  }</span>
<span id="cb47-9"><a href="#cb47-9"></a>}</span>
<span id="cb47-10"><a href="#cb47-10"></a>mean_rate_norm&lt;-num<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>mean_rate_norm</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>num&lt;-<span class="dv">0</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb49-4"><a href="#cb49-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5"></a>  UCL &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="cf">if</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>){</span>
<span id="cb49-7"><a href="#cb49-7"></a>    num&lt;-num<span class="op">+</span><span class="dv">1</span></span>
<span id="cb49-8"><a href="#cb49-8"></a>  }</span>
<span id="cb49-9"><a href="#cb49-9"></a>}</span>
<span id="cb49-10"><a href="#cb49-10"></a>fangcha_rate_norm&lt;-num<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb49-11"><a href="#cb49-11"></a>fangcha_rate_norm</span></code></pre></div>
<pre><code>## [1] 0.958</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>num&lt;-<span class="dv">0</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb51-4"><a href="#cb51-4"></a>  x &lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb51-5"><a href="#cb51-5"></a>  UCL &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="cf">if</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>){</span>
<span id="cb51-7"><a href="#cb51-7"></a>    num&lt;-num<span class="op">+</span><span class="dv">1</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  }</span>
<span id="cb51-9"><a href="#cb51-9"></a>}</span>
<span id="cb51-10"><a href="#cb51-10"></a>fangcha_rate_chisq&lt;-num<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>fangcha_rate_chisq</span></code></pre></div>
<pre><code>## [1] 0.823</code></pre>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<div id="section-8" class="section level4">
<h4>(1)</h4>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>u0=<span class="dv">1</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>p&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-7"><a href="#cb53-7"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb53-8"><a href="#cb53-8"></a>  m&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb53-9"><a href="#cb53-9"></a>  se&lt;-<span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb53-10"><a href="#cb53-10"></a>  t0&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(m<span class="op">-</span>u0)<span class="op">/</span>se</span>
<span id="cb53-11"><a href="#cb53-11"></a>  p[i]&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(t0),n<span class="dv">-1</span>))</span>
<span id="cb53-12"><a href="#cb53-12"></a>}</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="kw">mean</span>(p<span class="op">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.10691</code></pre>
</div>
<div id="section-9" class="section level4">
<h4>(2)</h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>u0=<span class="dv">1</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>p&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb55-7"><a href="#cb55-7"></a>  x&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb55-8"><a href="#cb55-8"></a>  me&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb55-9"><a href="#cb55-9"></a>  se&lt;-<span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb55-10"><a href="#cb55-10"></a>  t0&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(me<span class="op">-</span>u0)<span class="op">/</span>se</span>
<span id="cb55-11"><a href="#cb55-11"></a>  p[i]&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(t0),n<span class="dv">-1</span>))</span>
<span id="cb55-12"><a href="#cb55-12"></a>}</span>
<span id="cb55-13"><a href="#cb55-13"></a><span class="kw">mean</span>(p<span class="op">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.05171</code></pre>
</div>
<div id="section-10" class="section level4">
<h4>(3)</h4>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>u0=<span class="dv">1</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>p&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,m)</span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb57-7"><a href="#cb57-7"></a>  x&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb57-8"><a href="#cb57-8"></a>  me&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb57-9"><a href="#cb57-9"></a>  se&lt;-<span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span>
<span id="cb57-10"><a href="#cb57-10"></a>  t0&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(me<span class="op">-</span>u0)<span class="op">/</span>se</span>
<span id="cb57-11"><a href="#cb57-11"></a>  p[i]&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(t0),n<span class="dv">-1</span>))</span>
<span id="cb57-12"><a href="#cb57-12"></a>}</span>
<span id="cb57-13"><a href="#cb57-13"></a><span class="kw">mean</span>(p<span class="op">&lt;=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.08124</code></pre>
</div>
</div>
<div id="additon" class="section level3">
<h3>Additon</h3>
<div id="section-11" class="section level4">
<h4>(1)</h4>
<p><span class="math inline">\(H_0:\)</span>power of two methed is equal , <span class="math inline">\(H_1:\)</span> not equal</p>
</div>
<div id="section-12" class="section level4">
<h4>(2)</h4>
<p>I think we should use McNemar test,because I don’t know what it is.</p>
</div>
<div id="section-13" class="section level4">
<h4>(3)</h4>
<p>不会</p>
</div>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-14" class="section level1">
<h1>6.8</h1>
<p>为了减轻电脑的负担,我只跑一下d=2的情况.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb59-2"><a href="#cb59-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) </span>
<span id="cb59-3"><a href="#cb59-3"></a>d=<span class="dv">2</span>                                <span class="co">#degrees of freedom   </span></span>
<span id="cb59-4"><a href="#cb59-4"></a>cv2 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>cv1 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">025</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb59-6"><a href="#cb59-6"></a></span>
<span id="cb59-7"><a href="#cb59-7"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb59-8"><a href="#cb59-8"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb59-9"><a href="#cb59-9"></a>  x&lt;-<span class="kw">scale</span>(x,<span class="dt">center =</span> T,<span class="dt">scale=</span>F)</span>
<span id="cb59-10"><a href="#cb59-10"></a>  sigmahat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb59-11"><a href="#cb59-11"></a>  nn&lt;-<span class="kw">nrow</span>(x)</span>
<span id="cb59-12"><a href="#cb59-12"></a>  b1d&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>((x<span class="op">%*%</span><span class="kw">solve</span>(sigmahat)<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb59-13"><a href="#cb59-13"></a>  b1d&lt;-b1d<span class="op">/</span><span class="dv">6</span><span class="op">/</span>nn</span>
<span id="cb59-14"><a href="#cb59-14"></a>  <span class="kw">return</span>( b1d)</span>
<span id="cb59-15"><a href="#cb59-15"></a>}</span>
<span id="cb59-16"><a href="#cb59-16"></a></span>
<span id="cb59-17"><a href="#cb59-17"></a></span>
<span id="cb59-18"><a href="#cb59-18"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb59-19"><a href="#cb59-19"></a>m &lt;-<span class="st"> </span><span class="dv">500</span>  <span class="co">#num. repl. each sim.</span></span>
<span id="cb59-20"><a href="#cb59-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb59-21"><a href="#cb59-21"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb59-22"><a href="#cb59-22"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb59-23"><a href="#cb59-23"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i], <span class="kw">rep</span>(<span class="dv">0</span>, d),<span class="kw">diag</span>(d))</span>
<span id="cb59-24"><a href="#cb59-24"></a>    <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb59-25"><a href="#cb59-25"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk</span>(x)<span class="op">&gt;=</span><span class="st"> </span>cv2 <span class="op">|</span><span class="kw">sk</span>(x)<span class="op">&lt;=</span><span class="st"> </span>cv1 )</span>
<span id="cb59-26"><a href="#cb59-26"></a>  }</span>
<span id="cb59-27"><a href="#cb59-27"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb59-28"><a href="#cb59-28"></a>}</span>
<span id="cb59-29"><a href="#cb59-29"></a>p.reject</span></code></pre></div>
</div>
<div id="section-15" class="section level1">
<h1>6.10</h1>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb60-2"><a href="#cb60-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>m &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb60-6"><a href="#cb60-6"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb60-7"><a href="#cb60-7"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb60-8"><a href="#cb60-8"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb60-9"><a href="#cb60-9"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>  x&lt;-<span class="kw">scale</span>(x,<span class="dt">center =</span> T,<span class="dt">scale=</span>F)</span>
<span id="cb60-11"><a href="#cb60-11"></a>  sigmahat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb60-12"><a href="#cb60-12"></a>  nn&lt;-<span class="kw">nrow</span>(x)</span>
<span id="cb60-13"><a href="#cb60-13"></a>  b1d&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>((x<span class="op">%*%</span><span class="kw">solve</span>(sigmahat)<span class="op">%*%</span><span class="kw">t</span>(x))<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb60-14"><a href="#cb60-14"></a>  b1d&lt;-b1d<span class="op">/</span><span class="dv">6</span><span class="op">/</span>nn</span>
<span id="cb60-15"><a href="#cb60-15"></a>  <span class="kw">return</span>( b1d)</span>
<span id="cb60-16"><a href="#cb60-16"></a>}</span>
<span id="cb60-17"><a href="#cb60-17"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>d=<span class="dv">2</span>                                <span class="co">#degrees of freedom   </span></span>
<span id="cb60-19"><a href="#cb60-19"></a>cv2 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values</span></span>
<span id="cb60-20"><a href="#cb60-20"></a>cv1 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(alpha<span class="op">/</span><span class="dv">2</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb60-21"><a href="#cb60-21"></a><span class="co">#generating mixed multivariate normal </span></span>
<span id="cb60-22"><a href="#cb60-22"></a>hunhe&lt;-<span class="cf">function</span>(<span class="dt">size=</span><span class="dv">30</span>,<span class="dt">dimension=</span><span class="dv">2</span>,<span class="dt">eps=</span><span class="fl">0.1</span>){</span>
<span id="cb60-23"><a href="#cb60-23"></a>  xx&lt;-<span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,size<span class="op">*</span>dimension),size,dimension)</span>
<span id="cb60-24"><a href="#cb60-24"></a>  comp &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>eps, eps))</span>
<span id="cb60-25"><a href="#cb60-25"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>size){</span>
<span id="cb60-26"><a href="#cb60-26"></a>    <span class="cf">if</span>(comp[k]<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb60-27"><a href="#cb60-27"></a>      xx[k,]&lt;-<span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>,d), <span class="kw">diag</span>(d))</span>
<span id="cb60-28"><a href="#cb60-28"></a>    }</span>
<span id="cb60-29"><a href="#cb60-29"></a>    <span class="cf">else</span> {xx[k,]&lt;-<span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>,d), <span class="dv">10</span><span class="op">*</span><span class="kw">diag</span>(d))}</span>
<span id="cb60-30"><a href="#cb60-30"></a>  }</span>
<span id="cb60-31"><a href="#cb60-31"></a>  <span class="kw">return</span>(xx)</span>
<span id="cb60-32"><a href="#cb60-32"></a>}</span>
<span id="cb60-33"><a href="#cb60-33"></a></span>
<span id="cb60-34"><a href="#cb60-34"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb60-35"><a href="#cb60-35"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb60-36"><a href="#cb60-36"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb60-37"><a href="#cb60-37"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb60-38"><a href="#cb60-38"></a>    x&lt;-<span class="kw">hunhe</span>(n,d,e)</span>
<span id="cb60-39"><a href="#cb60-39"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk</span>(x) <span class="op">&gt;=</span><span class="st"> </span>cv2<span class="op">|</span><span class="kw">sk</span>(x) <span class="op">&lt;=</span><span class="st"> </span>cv1)</span>
<span id="cb60-40"><a href="#cb60-40"></a>  }</span>
<span id="cb60-41"><a href="#cb60-41"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb60-42"><a href="#cb60-42"></a>}</span>
<span id="cb60-43"><a href="#cb60-43"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb60-44"><a href="#cb60-44"></a></span>
<span id="cb60-45"><a href="#cb60-45"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb60-46"><a href="#cb60-46"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb60-47"><a href="#cb60-47"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb60-48"><a href="#cb60-48"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb60-49"><a href="#cb60-49"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb60-50"><a href="#cb60-50"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<div id="hw6" class="section level2">
<h2>Hw6</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7 7.8 7.9 and 7.B</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-16" class="section level1">
<h1>7.7</h1>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb61-2"><a href="#cb61-2"></a>R&lt;-<span class="dv">1000</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb61-4"><a href="#cb61-4"></a>theta_hat_b&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,R)</span>
<span id="cb61-5"><a href="#cb61-5"></a>theta_hat&lt;-(<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(scor))<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(scor))<span class="op">$</span>values)</span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb61-7"><a href="#cb61-7"></a>  ind&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n),<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb61-8"><a href="#cb61-8"></a>  theta&lt;-<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(scor[ind,]))</span>
<span id="cb61-9"><a href="#cb61-9"></a>  theta_hat_b[i]&lt;-(theta<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span>(<span class="kw">sum</span>(theta<span class="op">$</span>values))</span>
<span id="cb61-10"><a href="#cb61-10"></a>}</span>
<span id="cb61-11"><a href="#cb61-11"></a>theta_hat_bias&lt;-<span class="kw">mean</span>(theta_hat_b)<span class="op">-</span>theta_hat</span>
<span id="cb61-12"><a href="#cb61-12"></a>theta_hat_bias</span></code></pre></div>
<pre><code>## [1] 0.003961152</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>theta_hat_se&lt;-<span class="kw">sd</span>(theta_hat_b)</span>
<span id="cb63-2"><a href="#cb63-2"></a>theta_hat_se</span></code></pre></div>
<pre><code>## [1] 0.04607504</code></pre>
</div>
<div id="section-17" class="section level1">
<h1>7.8</h1>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>theta_hat_jack&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb65-3"><a href="#cb65-3"></a>  theta_hat_jack[i]&lt;-(<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values)</span>
<span id="cb65-4"><a href="#cb65-4"></a>}</span>
<span id="cb65-5"><a href="#cb65-5"></a>theta_hat_bias_jack&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta_hat_jack)<span class="op">-</span>theta_hat)</span>
<span id="cb65-6"><a href="#cb65-6"></a>theta_hat_bias_jack</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>theta_hat_se_jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(theta_hat_jack))</span>
<span id="cb67-2"><a href="#cb67-2"></a>theta_hat_se_jack</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="section-18" class="section level1">
<h1>7.9</h1>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>low1&lt;-<span class="kw">sort</span>(theta_hat_b)[R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb69-3"><a href="#cb69-3"></a>up1&lt;-<span class="kw">sort</span>(theta_hat_b)[R<span class="op">-</span>R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb69-4"><a href="#cb69-4"></a>z0&lt;-<span class="kw">qnorm</span>(<span class="kw">sum</span>(theta_hat_b<span class="op">&lt;</span>theta_hat)<span class="op">/</span>R)</span>
<span id="cb69-5"><a href="#cb69-5"></a>ahat&lt;-<span class="kw">sum</span>((theta_hat_b<span class="op">-</span>theta_hat)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">6</span><span class="op">/</span>(<span class="kw">sum</span>((theta_hat_b<span class="op">-</span>theta_hat)<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb69-6"><a href="#cb69-6"></a>alpha1&lt;-<span class="kw">pnorm</span>(z0<span class="op">+</span>(z0<span class="op">+</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>ahat<span class="op">*</span>(<span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>))))</span>
<span id="cb69-7"><a href="#cb69-7"></a>alpha2&lt;-<span class="kw">pnorm</span>(z0<span class="op">+</span>(z0<span class="op">+</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>ahat<span class="op">*</span>(<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))))</span>
<span id="cb69-8"><a href="#cb69-8"></a>low2&lt;-<span class="kw">sort</span>(theta_hat_b)[R<span class="op">*</span>alpha1]</span>
<span id="cb69-9"><a href="#cb69-9"></a>up2&lt;-<span class="kw">sort</span>(theta_hat_b)[R<span class="op">*</span>alpha2]</span>
<span id="cb69-10"><a href="#cb69-10"></a><span class="kw">cat</span>(<span class="st">&quot;percentile=[&quot;</span>,low1,<span class="st">&quot;,&quot;</span>,up1,<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</span>
<span id="cb69-11"><a href="#cb69-11"></a>         <span class="st">&quot;BCa=[&quot;</span>,low2,<span class="st">&quot;,&quot;</span>,up2,<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## percentile=[ 0.528767 , 0.7104255 ]   BCa=[ 0.518118 , 0.7022446 ]   </code></pre>
</div>
<div id="b" class="section level1">
<h1>7.B</h1>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># normal</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>R&lt;-<span class="dv">100</span> <span class="co"># number of resample</span></span>
<span id="cb71-4"><a href="#cb71-4"></a>N&lt;-<span class="dv">100</span> <span class="co"># num of MC</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>n&lt;-<span class="dv">5</span>  <span class="co"># num of sample</span></span>
<span id="cb71-6"><a href="#cb71-6"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb71-7"><a href="#cb71-7"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb71-8"><a href="#cb71-8"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb71-9"><a href="#cb71-9"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb71-10"><a href="#cb71-10"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-11"><a href="#cb71-11"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb71-12"><a href="#cb71-12"></a>}</span>
<span id="cb71-13"><a href="#cb71-13"></a>low_norm&lt;-up_norm&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb71-14"><a href="#cb71-14"></a>low_basic&lt;-up_basic&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb71-15"><a href="#cb71-15"></a>low_percent&lt;-up_percent&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb71-16"><a href="#cb71-16"></a></span>
<span id="cb71-17"><a href="#cb71-17"></a></span>
<span id="cb71-18"><a href="#cb71-18"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb71-19"><a href="#cb71-19"></a>  x&lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb71-20"><a href="#cb71-20"></a>  sk_b&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,R)</span>
<span id="cb71-21"><a href="#cb71-21"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb71-22"><a href="#cb71-22"></a>    ind&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n),<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb71-23"><a href="#cb71-23"></a>    sk_b[j]&lt;-<span class="kw">sk</span>(x[ind])</span>
<span id="cb71-24"><a href="#cb71-24"></a>  }</span>
<span id="cb71-25"><a href="#cb71-25"></a>  sk_hat&lt;-<span class="kw">sk</span>(x)</span>
<span id="cb71-26"><a href="#cb71-26"></a>  sk_hat_se&lt;-<span class="kw">sd</span>(sk_b)</span>
<span id="cb71-27"><a href="#cb71-27"></a>  low_norm[i]&lt;-sk_hat<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sk_hat_se</span>
<span id="cb71-28"><a href="#cb71-28"></a>  up_norm[i]&lt;-sk_hat<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sk_hat_se</span>
<span id="cb71-29"><a href="#cb71-29"></a>  low_basic[i]&lt;-<span class="dv">2</span><span class="op">*</span>sk_hat<span class="op">-</span><span class="kw">sort</span>(sk_b)[R<span class="op">-</span>R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb71-30"><a href="#cb71-30"></a>  up_basic[i]&lt;-<span class="dv">2</span><span class="op">*</span>sk_hat<span class="op">-</span><span class="kw">sort</span>(sk_b)[R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb71-31"><a href="#cb71-31"></a>  low_percent[i]&lt;-<span class="kw">sort</span>(sk_b)[R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb71-32"><a href="#cb71-32"></a>  up_percent[i]&lt;-<span class="kw">sort</span>(sk_b)[R<span class="op">-</span>R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb71-33"><a href="#cb71-33"></a>}</span>
<span id="cb71-34"><a href="#cb71-34"></a>por_left_norm&lt;-<span class="kw">sum</span>(low_norm<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-35"><a href="#cb71-35"></a>por_right_norm&lt;-<span class="kw">sum</span>(up_norm<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-36"><a href="#cb71-36"></a>por_norm&lt;-<span class="dv">1</span><span class="op">-</span>por_left_norm<span class="op">-</span>por_right_norm</span>
<span id="cb71-37"><a href="#cb71-37"></a>por_left_basic&lt;-<span class="kw">sum</span>(low_basic<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-38"><a href="#cb71-38"></a>por_right_basic&lt;-<span class="kw">sum</span>(up_basic<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-39"><a href="#cb71-39"></a>por_basic&lt;-<span class="dv">1</span><span class="op">-</span>por_left_basic<span class="op">-</span>por_right_basic</span>
<span id="cb71-40"><a href="#cb71-40"></a>por_left_percent&lt;-<span class="kw">sum</span>(low_percent<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-41"><a href="#cb71-41"></a>por_right_percent&lt;-<span class="kw">sum</span>(up_percent<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">/</span>R</span>
<span id="cb71-42"><a href="#cb71-42"></a>por_percent&lt;-<span class="dv">1</span><span class="op">-</span>por_left_percent<span class="op">-</span>por_right_percent</span>
<span id="cb71-43"><a href="#cb71-43"></a><span class="kw">cat</span>(<span class="st">&quot;coverage rate of normal BCI=&quot;</span>,por_norm,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb71-44"><a href="#cb71-44"></a>    por_left_norm,<span class="st">&quot;,rate of missing on right=&quot;</span>,por_right_norm,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb71-45"><a href="#cb71-45"></a>    <span class="st">&quot;coverage rate of basic BCI=&quot;</span>,por_basic,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb71-46"><a href="#cb71-46"></a>    por_left_basic,<span class="st">&quot;,rate of missing on right=&quot;</span>,por_right_basic,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb71-47"><a href="#cb71-47"></a>    <span class="st">&quot;coverage rate of percentile BCI=&quot;</span>,por_percent,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb71-48"><a href="#cb71-48"></a>    por_left_percent,<span class="st">&quot;,rate of missing on the right=&quot;</span>,por_right_percent,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## coverage rate of normal BCI= NA ,rate of missing on left= NA ,rate of missing on right= NA 
##  coverage rate of basic BCI= 0.67 ,rate of missing on left= 0.17 ,rate of missing on right= 0.16 
##  coverage rate of percentile BCI= 1 ,rate of missing on left= 0 ,rate of missing on the right= 0</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># chisq(5)</span></span>
<span id="cb73-2"><a href="#cb73-2"></a></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb73-4"><a href="#cb73-4"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb73-5"><a href="#cb73-5"></a>  sk_b&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,R)</span>
<span id="cb73-6"><a href="#cb73-6"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb73-7"><a href="#cb73-7"></a>    ind&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n),<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb73-8"><a href="#cb73-8"></a>    sk_b[j]&lt;-<span class="kw">sk</span>(x[ind])</span>
<span id="cb73-9"><a href="#cb73-9"></a>  }</span>
<span id="cb73-10"><a href="#cb73-10"></a>  sk_hat&lt;-<span class="kw">sk</span>(x)</span>
<span id="cb73-11"><a href="#cb73-11"></a>  sk_hat_se&lt;-<span class="kw">sd</span>(sk_b)</span>
<span id="cb73-12"><a href="#cb73-12"></a>  low_norm[i]&lt;-sk_hat<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sk_hat_se</span>
<span id="cb73-13"><a href="#cb73-13"></a>  up_norm[i]&lt;-sk_hat<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sk_hat_se</span>
<span id="cb73-14"><a href="#cb73-14"></a>  low_basic[i]&lt;-<span class="dv">2</span><span class="op">*</span>sk_hat<span class="op">-</span><span class="kw">sort</span>(sk_b)[R<span class="op">-</span>R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb73-15"><a href="#cb73-15"></a>  up_basic[i]&lt;-<span class="dv">2</span><span class="op">*</span>sk_hat<span class="op">-</span><span class="kw">sort</span>(sk_b)[R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb73-16"><a href="#cb73-16"></a>  low_percent[i]&lt;-<span class="kw">sort</span>(sk_b)[R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb73-17"><a href="#cb73-17"></a>  up_percent[i]&lt;-<span class="kw">sort</span>(sk_b)[R<span class="op">-</span>R<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb73-18"><a href="#cb73-18"></a>}</span>
<span id="cb73-19"><a href="#cb73-19"></a>skreal&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb73-20"><a href="#cb73-20"></a>por_left_norm&lt;-<span class="kw">sum</span>(low_norm<span class="op">&gt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-21"><a href="#cb73-21"></a>por_right_norm&lt;-<span class="kw">sum</span>(up_norm<span class="op">&lt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-22"><a href="#cb73-22"></a>por_norm&lt;-<span class="dv">1</span><span class="op">-</span>por_left_norm<span class="op">-</span>por_right_norm</span>
<span id="cb73-23"><a href="#cb73-23"></a>por_left_basic&lt;-<span class="kw">sum</span>(low_basic<span class="op">&gt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-24"><a href="#cb73-24"></a>por_right_basic&lt;-<span class="kw">sum</span>(up_basic<span class="op">&lt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-25"><a href="#cb73-25"></a>por_basic&lt;-<span class="dv">1</span><span class="op">-</span>por_left_basic<span class="op">-</span>por_right_basic</span>
<span id="cb73-26"><a href="#cb73-26"></a>por_left_percent&lt;-<span class="kw">sum</span>(low_percent<span class="op">&gt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-27"><a href="#cb73-27"></a>por_right_percent&lt;-<span class="kw">sum</span>(up_percent<span class="op">&lt;</span>skreal)<span class="op">/</span>R</span>
<span id="cb73-28"><a href="#cb73-28"></a>por_percent&lt;-<span class="dv">1</span><span class="op">-</span>por_left_percent<span class="op">-</span>por_right_percent</span>
<span id="cb73-29"><a href="#cb73-29"></a><span class="kw">cat</span>(<span class="st">&quot;coverage rate of normal BCI=&quot;</span>,por_norm,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb73-30"><a href="#cb73-30"></a>    por_left_norm,<span class="st">&quot;,rate of missing on right=&quot;</span>,por_right_norm,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb73-31"><a href="#cb73-31"></a>    <span class="st">&quot;coverage rate of basic BCI=&quot;</span>,por_basic,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb73-32"><a href="#cb73-32"></a>    por_left_basic,<span class="st">&quot;,rate of missing on right=&quot;</span>,por_right_basic,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb73-33"><a href="#cb73-33"></a>    <span class="st">&quot;coverage rate of percentile BCI=&quot;</span>,por_percent,<span class="st">&quot;,rate of missing on left=&quot;</span>,</span>
<span id="cb73-34"><a href="#cb73-34"></a>    por_left_percent,<span class="st">&quot;,rate of missing on the right=&quot;</span>,por_right_percent,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## coverage rate of normal BCI= NA ,rate of missing on left= NA ,rate of missing on right= NA 
##  coverage rate of basic BCI= 0.75 ,rate of missing on left= 0.03 ,rate of missing on right= 0.22 
##  coverage rate of percentile BCI= 0.89 ,rate of missing on left= 0 ,rate of missing on the right= 0.11</code></pre>
<div id="hw7" class="section level2">
<h2>HW7</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
</div>
</div>
<div id="exercises-8.1" class="section level1">
<h1>Exercises 8.1</h1>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations." class="section level1">
<h1>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</h1>
<p>Unequal variances and equal expectations</p>
<p>Unequal variances and unequal expectations</p>
<p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-19" class="section level1">
<h1>8.1</h1>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a>x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a>y&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb75-4"><a href="#cb75-4"></a>R &lt;-<span class="st"> </span><span class="dv">999</span>    <span class="co">#number of replicates</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)  <span class="co">#pooled sample</span></span>
<span id="cb75-6"><a href="#cb75-6"></a>K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb75-7"><a href="#cb75-7"></a>reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>t0 &lt;-<span class="st"> </span><span class="kw">cor</span>(x, y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb75-10"><a href="#cb75-10"></a>  <span class="co">#generate indices k for the first sample</span></span>
<span id="cb75-11"><a href="#cb75-11"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span><span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb75-12"><a href="#cb75-12"></a>  x1 &lt;-<span class="st"> </span>z[k]</span>
<span id="cb75-13"><a href="#cb75-13"></a>  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb75-14"><a href="#cb75-14"></a>  reps[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x1, y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-15"><a href="#cb75-15"></a>}</span>
<span id="cb75-16"><a href="#cb75-16"></a></span>
<span id="cb75-17"><a href="#cb75-17"></a>phat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(t0, reps) <span class="op">&gt;=</span><span class="st"> </span>t0)</span>
<span id="cb75-18"><a href="#cb75-18"></a><span class="kw">cat</span>(<span class="st">&quot;achieved significance level of the permutation test is &quot;</span> ,phat,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb75-19"><a href="#cb75-19"></a>test&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb75-20"><a href="#cb75-20"></a>p&lt;-test<span class="op">$</span>p.value</span>
<span id="cb75-21"><a href="#cb75-21"></a><span class="kw">cat</span>(<span class="st">&quot;p-value reported by cor.test is &quot;</span>,p,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="第二题" class="section level1">
<h1>第二题</h1>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="kw">library</span>(RANN) </span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="kw">library</span>(boot)</span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="kw">library</span>(energy)</span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="kw">library</span>(Ball)</span>
<span id="cb76-7"><a href="#cb76-7"></a></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="co"># (1) normal with mu1=mu2=0,sd1=1.5,sd2=1</span></span>
<span id="cb76-9"><a href="#cb76-9"></a></span>
<span id="cb76-10"><a href="#cb76-10"></a></span>
<span id="cb76-11"><a href="#cb76-11"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb76-12"><a href="#cb76-12"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb76-13"><a href="#cb76-13"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z);</span>
<span id="cb76-14"><a href="#cb76-14"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb76-15"><a href="#cb76-15"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># What is the first column?</span></span>
<span id="cb76-16"><a href="#cb76-16"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb76-17"><a href="#cb76-17"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb76-18"><a href="#cb76-18"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;=</span><span class="st"> </span>n1); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1)</span>
<span id="cb76-19"><a href="#cb76-19"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb76-20"><a href="#cb76-20"></a>}</span>
<span id="cb76-21"><a href="#cb76-21"></a></span>
<span id="cb76-22"><a href="#cb76-22"></a></span>
<span id="cb76-23"><a href="#cb76-23"></a></span>
<span id="cb76-24"><a href="#cb76-24"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="dv">0</span>; </span>
<span id="cb76-25"><a href="#cb76-25"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb76-26"><a href="#cb76-26"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb76-27"><a href="#cb76-27"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb76-28"><a href="#cb76-28"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb76-29"><a href="#cb76-29"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb76-30"><a href="#cb76-30"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb76-31"><a href="#cb76-31"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</span>
<span id="cb76-32"><a href="#cb76-32"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb76-33"><a href="#cb76-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb76-34"><a href="#cb76-34"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb76-35"><a href="#cb76-35"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu));</span>
<span id="cb76-36"><a href="#cb76-36"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb76-37"><a href="#cb76-37"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb76-38"><a href="#cb76-38"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb76-39"><a href="#cb76-39"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</span>
<span id="cb76-40"><a href="#cb76-40"></a>                           <span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb76-41"><a href="#cb76-41"></a>}</span>
<span id="cb76-42"><a href="#cb76-42"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb76-43"><a href="#cb76-43"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb76-44"><a href="#cb76-44"></a>pow</span>
<span id="cb76-45"><a href="#cb76-45"></a></span>
<span id="cb76-46"><a href="#cb76-46"></a><span class="co"># (2)normal with mu1=0,mu2=0.3,sd1=1.5,sd2=1</span></span>
<span id="cb76-47"><a href="#cb76-47"></a></span>
<span id="cb76-48"><a href="#cb76-48"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; </span>
<span id="cb76-49"><a href="#cb76-49"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb76-50"><a href="#cb76-50"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb76-51"><a href="#cb76-51"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb76-52"><a href="#cb76-52"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb76-53"><a href="#cb76-53"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb76-54"><a href="#cb76-54"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb76-55"><a href="#cb76-55"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</span>
<span id="cb76-56"><a href="#cb76-56"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb76-57"><a href="#cb76-57"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb76-58"><a href="#cb76-58"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb76-59"><a href="#cb76-59"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu));</span>
<span id="cb76-60"><a href="#cb76-60"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb76-61"><a href="#cb76-61"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb76-62"><a href="#cb76-62"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb76-63"><a href="#cb76-63"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</span>
<span id="cb76-64"><a href="#cb76-64"></a>                           <span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb76-65"><a href="#cb76-65"></a>}</span>
<span id="cb76-66"><a href="#cb76-66"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb76-67"><a href="#cb76-67"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb76-68"><a href="#cb76-68"></a>pow</span>
<span id="cb76-69"><a href="#cb76-69"></a></span>
<span id="cb76-70"><a href="#cb76-70"></a><span class="co"># (3) t distribution with df=1 vs 0.4N(0,1)+0.6N(1,1)</span></span>
<span id="cb76-71"><a href="#cb76-71"></a></span>
<span id="cb76-72"><a href="#cb76-72"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">1</span>; </span>
<span id="cb76-73"><a href="#cb76-73"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb76-74"><a href="#cb76-74"></a>hunhe&lt;-<span class="cf">function</span>(samsize,<span class="dt">mu1=</span><span class="dv">0</span>,<span class="dt">mu2=</span><span class="dv">1</span>,<span class="dt">sd1=</span><span class="dv">1</span>,<span class="dt">sd2=</span><span class="dv">1</span>,<span class="dt">p=</span><span class="fl">0.4</span>){</span>
<span id="cb76-75"><a href="#cb76-75"></a>  x&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,samsize)</span>
<span id="cb76-76"><a href="#cb76-76"></a>  u&lt;-<span class="kw">runif</span>(samsize)</span>
<span id="cb76-77"><a href="#cb76-77"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>samsize){</span>
<span id="cb76-78"><a href="#cb76-78"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="fl">0.4</span>){</span>
<span id="cb76-79"><a href="#cb76-79"></a>      x[i]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,mu1,sd1)</span>
<span id="cb76-80"><a href="#cb76-80"></a>    }</span>
<span id="cb76-81"><a href="#cb76-81"></a>    <span class="cf">if</span>(u[i]<span class="op">&gt;</span><span class="fl">0.4</span>){</span>
<span id="cb76-82"><a href="#cb76-82"></a>      x[i]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,mu2,sd2)</span>
<span id="cb76-83"><a href="#cb76-83"></a>    }</span>
<span id="cb76-84"><a href="#cb76-84"></a>  }</span>
<span id="cb76-85"><a href="#cb76-85"></a>  <span class="kw">return</span>(x)</span>
<span id="cb76-86"><a href="#cb76-86"></a>}</span>
<span id="cb76-87"><a href="#cb76-87"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb76-88"><a href="#cb76-88"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb76-89"><a href="#cb76-89"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1,<span class="dt">df=</span>n1),<span class="dt">ncol=</span><span class="dv">1</span>);</span>
<span id="cb76-90"><a href="#cb76-90"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">hunhe</span>(n2),<span class="dt">ncol=</span><span class="dv">1</span>);</span>
<span id="cb76-91"><a href="#cb76-91"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb76-92"><a href="#cb76-92"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb76-93"><a href="#cb76-93"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb76-94"><a href="#cb76-94"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</span>
<span id="cb76-95"><a href="#cb76-95"></a>                           <span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb76-96"><a href="#cb76-96"></a>}</span>
<span id="cb76-97"><a href="#cb76-97"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb76-98"><a href="#cb76-98"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb76-99"><a href="#cb76-99"></a>pow</span>
<span id="cb76-100"><a href="#cb76-100"></a></span>
<span id="cb76-101"><a href="#cb76-101"></a><span class="co"># (4) Unbalanced samples</span></span>
<span id="cb76-102"><a href="#cb76-102"></a></span>
<span id="cb76-103"><a href="#cb76-103"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.3</span>; </span>
<span id="cb76-104"><a href="#cb76-104"></a>n1 &lt;-<span class="dv">10</span>; n2 &lt;-<span class="st"> </span><span class="dv">100</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb76-105"><a href="#cb76-105"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb76-106"><a href="#cb76-106"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb76-107"><a href="#cb76-107"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb76-108"><a href="#cb76-108"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb76-109"><a href="#cb76-109"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb76-110"><a href="#cb76-110"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</span>
<span id="cb76-111"><a href="#cb76-111"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb76-112"><a href="#cb76-112"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb76-113"><a href="#cb76-113"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb76-114"><a href="#cb76-114"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu));</span>
<span id="cb76-115"><a href="#cb76-115"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb76-116"><a href="#cb76-116"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb76-117"><a href="#cb76-117"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb76-118"><a href="#cb76-118"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</span>
<span id="cb76-119"><a href="#cb76-119"></a>                           <span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb76-120"><a href="#cb76-120"></a>}</span>
<span id="cb76-121"><a href="#cb76-121"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb76-122"><a href="#cb76-122"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb76-123"><a href="#cb76-123"></a>pow</span></code></pre></div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercies 9.3 and 9.8</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-20" class="section level1">
<h1>9.3</h1>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb77-3"><a href="#cb77-3"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="co">#提议分布用正态分布</span></span>
<span id="cb77-5"><a href="#cb77-5"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb77-6"><a href="#cb77-6"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb77-7"><a href="#cb77-7"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</span>
<span id="cb77-9"><a href="#cb77-9"></a>  xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb77-10"><a href="#cb77-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean=</span>xt)</span>
<span id="cb77-11"><a href="#cb77-11"></a>  num &lt;-<span class="st"> </span><span class="kw">dcauchy</span>(y) </span>
<span id="cb77-12"><a href="#cb77-12"></a>  den &lt;-<span class="st"> </span><span class="kw">dcauchy</span>(xt) </span>
<span id="cb77-13"><a href="#cb77-13"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb77-14"><a href="#cb77-14"></a>    x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb77-15"><a href="#cb77-15"></a>    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb77-16"><a href="#cb77-16"></a>  } </span>
<span id="cb77-17"><a href="#cb77-17"></a>}</span>
<span id="cb77-18"><a href="#cb77-18"></a></span>
<span id="cb77-19"><a href="#cb77-19"></a>x&lt;-x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)]</span>
<span id="cb77-20"><a href="#cb77-20"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb77-21"><a href="#cb77-21"></a>QR &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a) <span class="co">#quantiles of Cauchy</span></span>
<span id="cb77-22"><a href="#cb77-22"></a>Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(x, a)</span>
<span id="cb77-23"><a href="#cb77-23"></a><span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb77-24"><a href="#cb77-24"></a>       <span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">lines</span>(QR,<span class="kw">dcauchy</span>(QR))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a>Q &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a)</span>
<span id="cb79-3"><a href="#cb79-3"></a>Qx&lt;-<span class="kw">quantile</span>(x,a)</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q,Qx),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##          Q     Qx
## 5%  -6.314 -4.207
## 10% -3.078 -2.053
## 20% -1.376 -0.997
## 30% -0.727 -0.530
## 40% -0.325 -0.193
## 50%  0.000  0.108
## 60%  0.325  0.427
## 70%  0.727  0.857
## 80%  1.376  1.567
## 90%  3.078  3.530
## 95%  6.314  5.728</code></pre>
</div>
<div id="section-21" class="section level1">
<h1>9.8</h1>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb81-3"><a href="#cb81-3"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb81-6"><a href="#cb81-6"></a></span>
<span id="cb81-7"><a href="#cb81-7"></a>n&lt;-<span class="dv">15</span></span>
<span id="cb81-8"><a href="#cb81-8"></a>a&lt;-<span class="dv">5</span></span>
<span id="cb81-9"><a href="#cb81-9"></a>b&lt;-<span class="dv">5</span></span>
<span id="cb81-10"><a href="#cb81-10"></a>X[<span class="dv">1</span>,]&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb81-12"><a href="#cb81-12"></a>  x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb81-13"><a href="#cb81-13"></a>  X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb81-14"><a href="#cb81-14"></a>  x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb81-15"><a href="#cb81-15"></a>  X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, x1<span class="op">+</span>a, n<span class="op">-</span>x1<span class="op">+</span>b)</span>
<span id="cb81-16"><a href="#cb81-16"></a>}</span>
<span id="cb81-17"><a href="#cb81-17"></a>x &lt;-<span class="st"> </span>X[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N, ]</span>
<span id="cb81-18"><a href="#cb81-18"></a></span>
<span id="cb81-19"><a href="#cb81-19"></a><span class="kw">plot</span>(x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb81-20"><a href="#cb81-20"></a>     <span class="dt">ylab=</span><span class="kw">bquote</span>(X[<span class="dv">2</span>]), <span class="dt">ylim=</span><span class="kw">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cont." class="section level1">
<h1>9.3(cont.)</h1>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb82-3"><a href="#cb82-3"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb82-4"><a href="#cb82-4"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb82-6"><a href="#cb82-6"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb82-7"><a href="#cb82-7"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb82-8"><a href="#cb82-8"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb82-9"><a href="#cb82-9"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb82-10"><a href="#cb82-10"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb82-12"><a href="#cb82-12"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb82-13"><a href="#cb82-13"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb82-14"><a href="#cb82-14"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb82-15"><a href="#cb82-15"></a>}</span>
<span id="cb82-16"><a href="#cb82-16"></a>cauchy.chain &lt;-<span class="st"> </span><span class="cf">function</span>(N, X1) {</span>
<span id="cb82-17"><a href="#cb82-17"></a>  <span class="co">#generates a Metropolis chain for Cauchy(0,1)</span></span>
<span id="cb82-18"><a href="#cb82-18"></a>  <span class="co">#with N(X[t], 1) proposal distribution</span></span>
<span id="cb82-19"><a href="#cb82-19"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb82-20"><a href="#cb82-20"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb82-21"><a href="#cb82-21"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb82-22"><a href="#cb82-22"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb82-23"><a href="#cb82-23"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb82-24"><a href="#cb82-24"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb82-25"><a href="#cb82-25"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean=</span>xt,<span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb82-26"><a href="#cb82-26"></a>    num &lt;-<span class="st"> </span><span class="kw">dcauchy</span>(y) </span>
<span id="cb82-27"><a href="#cb82-27"></a>    den &lt;-<span class="st"> </span><span class="kw">dcauchy</span>(xt) </span>
<span id="cb82-28"><a href="#cb82-28"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb82-29"><a href="#cb82-29"></a>      x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb82-30"><a href="#cb82-30"></a>      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb82-31"><a href="#cb82-31"></a>    } </span>
<span id="cb82-32"><a href="#cb82-32"></a>  }</span>
<span id="cb82-33"><a href="#cb82-33"></a>  <span class="kw">return</span>(x)</span>
<span id="cb82-34"><a href="#cb82-34"></a>}</span>
<span id="cb82-35"><a href="#cb82-35"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb82-36"><a href="#cb82-36"></a>n &lt;-<span class="st"> </span><span class="dv">20000</span> <span class="co">#length of chains</span></span>
<span id="cb82-37"><a href="#cb82-37"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb82-38"><a href="#cb82-38"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb82-39"><a href="#cb82-39"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">-10</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb82-40"><a href="#cb82-40"></a><span class="co">#generate the chains</span></span>
<span id="cb82-41"><a href="#cb82-41"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb82-42"><a href="#cb82-42"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb82-43"><a href="#cb82-43"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">cauchy.chain</span>(n, x0[i])</span>
<span id="cb82-44"><a href="#cb82-44"></a>}</span>
<span id="cb82-45"><a href="#cb82-45"></a>  </span>
<span id="cb82-46"><a href="#cb82-46"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb82-47"><a href="#cb82-47"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb82-48"><a href="#cb82-48"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)){</span>
<span id="cb82-49"><a href="#cb82-49"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb82-50"><a href="#cb82-50"></a>}</span>
<span id="cb82-51"><a href="#cb82-51"></a>  </span>
<span id="cb82-52"><a href="#cb82-52"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.262184</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb84-2"><a href="#cb84-2"></a></span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb84-4"><a href="#cb84-4"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb84-5"><a href="#cb84-5"></a>       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb84-6"><a href="#cb84-6"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb85-4"><a href="#cb85-4"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb85-5"><a href="#cb85-5"></a>}</span>
<span id="cb85-6"><a href="#cb85-6"></a></span>
<span id="cb85-7"><a href="#cb85-7"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb85-8"><a href="#cb85-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">min</span>(<span class="kw">which</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n]<span class="op">&lt;=</span><span class="fl">1.2</span>))</span></code></pre></div>
<pre><code>## [1] 10805</code></pre>
<p>可以看到链从一万左右个样本开始收敛.我们运行这个链.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>n&lt;-<span class="kw">min</span>(<span class="kw">which</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n]<span class="op">&lt;=</span><span class="fl">1.2</span>))<span class="op">+</span>b</span>
<span id="cb88-3"><a href="#cb88-3"></a>x&lt;-<span class="kw">cauchy.chain</span>(n,<span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb88-4"><a href="#cb88-4"></a>x&lt;-x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)]</span>
<span id="cb88-5"><a href="#cb88-5"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb88-6"><a href="#cb88-6"></a>QR &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a) <span class="co">#quantiles of Cauchy</span></span>
<span id="cb88-7"><a href="#cb88-7"></a>Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(x, a)</span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb88-9"><a href="#cb88-9"></a>       <span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="kw">lines</span>(QR,<span class="kw">dcauchy</span>(QR))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb90-2"><a href="#cb90-2"></a>Q &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a)</span>
<span id="cb90-3"><a href="#cb90-3"></a>Qx&lt;-<span class="kw">quantile</span>(x,a)</span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q,Qx),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##          Q     Qx
## 5%  -6.314 -4.568
## 10% -3.078 -2.480
## 20% -1.376 -1.142
## 30% -0.727 -0.583
## 40% -0.325 -0.221
## 50%  0.000  0.092
## 60%  0.325  0.427
## 70%  0.727  0.891
## 80%  1.376  1.770
## 90%  3.078  4.141
## 95%  6.314  9.249</code></pre>
<p>也看不太出哪里收敛了.</p>
</div>
<div id="cont.-1" class="section level1">
<h1>9.8(cont.)</h1>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb92-2"><a href="#cb92-2"></a></span>
<span id="cb92-3"><a href="#cb92-3"></a>bivariate.chain&lt;-<span class="cf">function</span>(N,X1,<span class="dt">n=</span><span class="dv">15</span>,<span class="dt">a=</span><span class="dv">5</span>,<span class="dt">b=</span><span class="dv">5</span>){</span>
<span id="cb92-4"><a href="#cb92-4"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb92-5"><a href="#cb92-5"></a>  X[<span class="dv">1</span>,]&lt;-X1</span>
<span id="cb92-6"><a href="#cb92-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb92-7"><a href="#cb92-7"></a>    x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb92-8"><a href="#cb92-8"></a>    X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb92-9"><a href="#cb92-9"></a>    x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb92-10"><a href="#cb92-10"></a>    X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, x1<span class="op">+</span>a, n<span class="op">-</span>x1<span class="op">+</span>b)</span>
<span id="cb92-11"><a href="#cb92-11"></a>  }</span>
<span id="cb92-12"><a href="#cb92-12"></a>  <span class="kw">return</span>(X)</span>
<span id="cb92-13"><a href="#cb92-13"></a>}</span>
<span id="cb92-14"><a href="#cb92-14"></a>k&lt;-<span class="dv">4</span></span>
<span id="cb92-15"><a href="#cb92-15"></a>n&lt;-<span class="dv">30000</span></span>
<span id="cb92-16"><a href="#cb92-16"></a>b&lt;-<span class="dv">1000</span></span>
<span id="cb92-17"><a href="#cb92-17"></a>x0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>),<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb92-18"><a href="#cb92-18"></a></span>
<span id="cb92-19"><a href="#cb92-19"></a>Xone &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb92-20"><a href="#cb92-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb92-21"><a href="#cb92-21"></a>  Xone[i, ] &lt;-<span class="st"> </span><span class="kw">bivariate.chain</span>(n, x0[i,])[,<span class="dv">1</span>]</span>
<span id="cb92-22"><a href="#cb92-22"></a>}</span>
<span id="cb92-23"><a href="#cb92-23"></a>psione &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(Xone, <span class="dv">1</span>, cumsum))</span>
<span id="cb92-24"><a href="#cb92-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psione)){</span>
<span id="cb92-25"><a href="#cb92-25"></a>  psione[i,] &lt;-<span class="st"> </span>psione[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psione))</span>
<span id="cb92-26"><a href="#cb92-26"></a>}</span>
<span id="cb92-27"><a href="#cb92-27"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psione))</span></code></pre></div>
<pre><code>## [1] 1.454496</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>rhatone &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb94-3"><a href="#cb94-3"></a>  rhatone[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psione[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb94-4"><a href="#cb94-4"></a>}</span>
<span id="cb94-5"><a href="#cb94-5"></a></span>
<span id="cb94-6"><a href="#cb94-6"></a>Xtwo &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb94-8"><a href="#cb94-8"></a>  Xtwo[i, ] &lt;-<span class="st"> </span><span class="kw">bivariate.chain</span>(n, x0[i,])[,<span class="dv">2</span>]</span>
<span id="cb94-9"><a href="#cb94-9"></a>}</span>
<span id="cb94-10"><a href="#cb94-10"></a>psitwo &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(Xtwo, <span class="dv">1</span>, cumsum))</span>
<span id="cb94-11"><a href="#cb94-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psitwo)){</span>
<span id="cb94-12"><a href="#cb94-12"></a>  psitwo[i,] &lt;-<span class="st"> </span>psitwo[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psitwo))</span>
<span id="cb94-13"><a href="#cb94-13"></a>}</span>
<span id="cb94-14"><a href="#cb94-14"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psitwo))</span></code></pre></div>
<pre><code>## [1] 1.118843</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>rhattwo &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb96-3"><a href="#cb96-3"></a>  rhattwo[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psitwo[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb96-4"><a href="#cb96-4"></a>}</span>
<span id="cb96-5"><a href="#cb96-5"></a></span>
<span id="cb96-6"><a href="#cb96-6"></a></span>
<span id="cb96-7"><a href="#cb96-7"></a></span>
<span id="cb96-8"><a href="#cb96-8"></a><span class="kw">plot</span>(rhatone[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb96-9"><a href="#cb96-9"></a><span class="kw">lines</span>(rhattwo[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb96-10"><a href="#cb96-10"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> 这破玩意儿搞半天也不收敛，就这样吧</p>
<div id="hw9" class="section level2">
<h2>HW9</h2>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Exercises 11.3 and 11.5</p>
<p>Suppose $T_1, . . . , T_n $are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are$ Y_i = T_iI(T_i ≤ τ ) + I(T_i &gt; ), i = 1, . . . , n. $Suppose <span class="math inline">\(\tau = 1\)</span> and the observed Yi values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate λ, compare your result with the observed data MLE (note: Yi follows a mixture distribution)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-22" class="section level1">
<h1>11.3</h1>
<div id="a-1" class="section level3">
<h3>(a)</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>ak&lt;-<span class="cf">function</span>(k,<span class="dt">d=</span><span class="dv">2</span>,<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)){</span>
<span id="cb97-2"><a href="#cb97-2"></a>  result&lt;-<span class="kw">sum</span>(a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">factorial</span>(k)<span class="op">*</span>(<span class="op">-</span><span class="kw">sum</span>(a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>k<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb97-3"><a href="#cb97-3"></a>  <span class="kw">return</span>(result)</span>
<span id="cb97-4"><a href="#cb97-4"></a>}</span></code></pre></div>
</div>
<div id="b-1" class="section level3">
<h3>(b)</h3>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>Sn&lt;-<span class="cf">function</span>(<span class="dt">d=</span><span class="dv">2</span>,<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">epsilon=</span><span class="fl">1e-7</span>){</span>
<span id="cb98-2"><a href="#cb98-2"></a>k&lt;-<span class="dv">1</span></span>
<span id="cb98-3"><a href="#cb98-3"></a>sn&lt;-<span class="dv">0</span></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="cf">while</span> (<span class="kw">abs</span>(<span class="kw">ak</span>(k,<span class="dt">d=</span>d,<span class="dt">a=</span>a))<span class="op">&gt;=</span><span class="fl">1e-7</span>) {</span>
<span id="cb98-5"><a href="#cb98-5"></a>  k&lt;-k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb98-6"><a href="#cb98-6"></a>  sn&lt;-sn<span class="op">+</span><span class="kw">ak</span>(k,<span class="dt">d=</span>d,<span class="dt">a=</span>a)</span>
<span id="cb98-7"><a href="#cb98-7"></a>}</span>
<span id="cb98-8"><a href="#cb98-8"></a><span class="kw">return</span>(sn)</span>
<span id="cb98-9"><a href="#cb98-9"></a>}</span></code></pre></div>
</div>
<div id="c" class="section level3">
<h3>(c)</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">Sn</span>(<span class="dt">d=</span><span class="dv">2</span>,<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.1822609</code></pre>
</div>
</div>
<div id="section-23" class="section level1">
<h1>11.5</h1>
<p>k=500,1000时,error了.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</span>
<span id="cb101-2"><a href="#cb101-2"></a>B &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(K))</span>
<span id="cb101-3"><a href="#cb101-3"></a>i&lt;-<span class="dv">1</span></span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="cf">for</span>(k <span class="cf">in</span> K){</span>
<span id="cb101-5"><a href="#cb101-5"></a>  ck&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">log</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb101-6"><a href="#cb101-6"></a>  ckk&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">log</span>(pi<span class="op">*</span>(k))) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb101-7"><a href="#cb101-7"></a>  f&lt;-<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb101-8"><a href="#cb101-8"></a>    <span class="kw">return</span>((ck<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>), <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value) <span class="op">-</span><span class="st"> </span>(ckk<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>), <span class="dt">lower =</span> <span class="dv">0</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value))</span>
<span id="cb101-9"><a href="#cb101-9"></a>  }</span>
<span id="cb101-10"><a href="#cb101-10"></a>  B[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">0.01</span>, <span class="dt">upper =</span> <span class="dv">1</span><span class="op">+</span><span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span>)<span class="op">$</span>root</span>
<span id="cb101-11"><a href="#cb101-11"></a>  i&lt;-i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb101-12"><a href="#cb101-12"></a>}</span></code></pre></div>
<p>11.4,还是k=500,1000时有error</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>)</span>
<span id="cb102-2"><a href="#cb102-2"></a>BB&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(K))</span>
<span id="cb102-3"><a href="#cb102-3"></a>i&lt;-<span class="dv">1</span></span>
<span id="cb102-4"><a href="#cb102-4"></a><span class="cf">for</span>(k <span class="cf">in</span> K){</span>
<span id="cb102-5"><a href="#cb102-5"></a>  ck&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">log</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb102-6"><a href="#cb102-6"></a>  ckk&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">log</span>(pi<span class="op">*</span>(k))) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb102-7"><a href="#cb102-7"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb102-8"><a href="#cb102-8"></a>    <span class="kw">return</span>((ck<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>),</span>
<span id="cb102-9"><a href="#cb102-9"></a>                           <span class="dt">lower =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">upper =</span> <span class="ot">Inf</span>)<span class="op">$</span>value) <span class="op">-</span><span class="st"> </span>(ckk<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>), </span>
<span id="cb102-10"><a href="#cb102-10"></a>                                                                                                      <span class="dt">lower =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">upper =</span> <span class="ot">Inf</span>)<span class="op">$</span>value))</span>
<span id="cb102-11"><a href="#cb102-11"></a>  }</span>
<span id="cb102-12"><a href="#cb102-12"></a>  BB[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">0.01</span>, <span class="dt">upper =</span> <span class="dv">1</span><span class="op">+</span><span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span>)<span class="op">$</span>root</span>
<span id="cb102-13"><a href="#cb102-13"></a>  i&lt;-i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb102-14"><a href="#cb102-14"></a>}</span>
<span id="cb102-15"><a href="#cb102-15"></a><span class="kw">cbind</span>(K,B,BB)</span></code></pre></div>
<pre><code>##         K        B       BB
##  [1,]   4 1.492103 1.492103
##  [2,]   5 1.533576 1.533576
##  [3,]   6 1.562721 1.562721
##  [4,]   7 1.584427 1.584427
##  [5,]   8 1.601166 1.601166
##  [6,]   9 1.614524 1.614524
##  [7,]  10 1.625385 1.625385
##  [8,]  11 1.634415 1.634415
##  [9,]  12 1.642027 1.642027
## [10,]  13 1.648536 1.648536
## [11,]  14 1.654175 1.654175
## [12,]  15 1.659097 1.659097
## [13,]  16 1.663408 1.663408
## [14,]  17 1.667301 1.667301
## [15,]  18 1.670724 1.670724
## [16,]  19 1.673819 1.673819
## [17,]  20 1.676589 1.676589
## [18,]  21 1.679154 1.679154
## [19,]  22 1.681470 1.681470
## [20,]  23 1.683610 1.683610
## [21,]  24 1.685548 1.685548
## [22,]  25 1.687347 1.687347
## [23,] 100 1.720610 1.720610</code></pre>
</div>
<div id="e.m." class="section level1">
<h1>E.M.</h1>
<p>因为是<span class="math inline">\(\tau\)</span>时刻截尾,我们设此时有m个已观测到的数据,设完全数据为<span class="math inline">\(t_i,i=1,\ldots,n\)</span>.由期望为<span class="math inline">\(\lambda\)</span>,可知<span class="math inline">\(T_i \sim Exp(\frac{1}{\lambda})\)</span>.由条件概率公式,当<span class="math inline">\(Y_i=1\)</span>时，<span class="math inline">\(T_i|Y_i=1\)</span>为1到无穷上参数为<span class="math inline">\(1/\lambda\)</span>的指数分布(指数分布的无记忆性).<span class="math inline">\(L(\lambda,\mathbf{t},\mathbf{y})=\frac{1}{\lambda^n}\exp\{\frac{1}{\lambda}\sum_{i=1}^{n}t_i\}\)</span>.对数似然函数为<span class="math inline">\(l(\lambda,\mathbf{t},\mathbf{y})=-n\ln\lambda-\frac{1}{\lambda}\sum t_i\)</span></p>
<p>E step:</p>
<p><span class="math inline">\(Q(\lambda,\lambda^{(i)})=E[l(\lambda)|Y,\lambda^{(i)}]=-n\ln \lambda-\frac{1}{\lambda}\sum_{i=1}^{m}y_i-\frac{1}{\lambda}E[\sum_{i=m+1}^{n}t_i|Y_i=1,\lambda^{(i)}]\)</span></p>
<p>则<span class="math inline">\(Q(\lambda,\lambda^{(i)})=-n\ln \lambda-\frac{1}{\lambda}\sum_{i=1}^{m}y_i-\frac{n-m}{\lambda}(1+\lambda^{(i)})\)</span></p>
<p>M step:</p>
<p>计算<span class="math inline">\(\frac{\partial Q(\lambda,\lambda^{(i)})}{\partial \lambda}=0\)</span>,可得<span class="math inline">\(\lambda^{(i+1)}=\frac{\sum^m y_i+(n-m)(1+\lambda^{(i)})}{n}\)</span></p>
<p>由EM算法的收敛性可知，<span class="math inline">\(\lambda^{(i)}\rightarrow \frac{\sum^m y_i+(n-m)}{m}\)</span>,由之前数理统计那本书可知<span class="math inline">\(\lambda\)</span>的极大似然估计为<span class="math inline">\(\frac{\sum^m y_i+(n-m)}{m}\)</span>,所以他们是一样的.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>Y&lt;-<span class="kw">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb104-2"><a href="#cb104-2"></a></span>
<span id="cb104-3"><a href="#cb104-3"></a>EM&lt;-<span class="cf">function</span>(y,<span class="dt">max.itr=</span><span class="dv">1000</span>,<span class="dt">eps=</span><span class="fl">1e-6</span>){</span>
<span id="cb104-4"><a href="#cb104-4"></a>  i&lt;-<span class="dv">1</span></span>
<span id="cb104-5"><a href="#cb104-5"></a>  n&lt;-<span class="kw">length</span>(y)</span>
<span id="cb104-6"><a href="#cb104-6"></a>  m&lt;-n<span class="op">-</span><span class="kw">sum</span>(y<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb104-7"><a href="#cb104-7"></a>  lambda1&lt;-<span class="dv">1</span></span>
<span id="cb104-8"><a href="#cb104-8"></a>  lambda2&lt;-<span class="kw">mean</span>(y)</span>
<span id="cb104-9"><a href="#cb104-9"></a>  <span class="cf">while</span>(<span class="kw">abs</span>(lambda1<span class="op">-</span>lambda2)<span class="op">&gt;=</span>eps<span class="op">&amp;</span>i<span class="op">&lt;=</span>max.itr){</span>
<span id="cb104-10"><a href="#cb104-10"></a>    lambda1&lt;-lambda2</span>
<span id="cb104-11"><a href="#cb104-11"></a>    lambda2&lt;-(<span class="kw">sum</span>(y[<span class="dv">1</span><span class="op">:</span>m])<span class="op">+</span>(n<span class="op">-</span>m)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>lambda2))<span class="op">/</span>n</span>
<span id="cb104-12"><a href="#cb104-12"></a>    i&lt;-i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb104-13"><a href="#cb104-13"></a>  }</span>
<span id="cb104-14"><a href="#cb104-14"></a>  result&lt;-<span class="kw">c</span>(lambda2,i)</span>
<span id="cb104-15"><a href="#cb104-15"></a>  <span class="kw">return</span>(result)</span>
<span id="cb104-16"><a href="#cb104-16"></a>}</span>
<span id="cb104-17"><a href="#cb104-17"></a></span>
<span id="cb104-18"><a href="#cb104-18"></a>n&lt;-<span class="kw">length</span>(Y)</span>
<span id="cb104-19"><a href="#cb104-19"></a>m&lt;-n<span class="op">-</span><span class="kw">sum</span>(Y<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb104-20"><a href="#cb104-20"></a>(<span class="kw">sum</span>(Y[<span class="dv">1</span><span class="op">:</span>m])<span class="op">+</span>(n<span class="op">-</span>m))<span class="op">/</span>m <span class="co"># likelihood</span></span></code></pre></div>
<pre><code>## [1] 1.098571</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="kw">EM</span>(Y)[<span class="dv">1</span>] <span class="co"># E.M.</span></span></code></pre></div>
<pre><code>## [1] 1.098571</code></pre>
<div id="hw10" class="section level2">
<h2>HW10</h2>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Exercises 1 and 5 (page 204, Advanced R)</p>
<p>Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-24" class="section level1">
<h1>204.1</h1>
<p>因为mean这个函数有两个aeguments,一个是x,一个是trim,trim用来去掉尾部的一部分后再取平均,第一个lapply直接定义trim的函数,分别返回去掉x的尾部trims那么多的数据之后的平均值,和第二个lapplyx先mean一下再指定额外argument一样.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>trims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb108-2"><a href="#cb108-2"></a>x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.9999711
## 
## [[2]]
## [1] 0.2789011
## 
## [[3]]
## [1] 0.24661
## 
## [[4]]
## [1] 0.2300114</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.9999711
## 
## [[2]]
## [1] 0.2789011
## 
## [[3]]
## [1] 0.24661
## 
## [[4]]
## [1] 0.2300114</code></pre>
</div>
<div id="section-25" class="section level1">
<h1>204.5.3</h1>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb112-2"><a href="#cb112-2"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb112-3"><a href="#cb112-3"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb112-4"><a href="#cb112-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb112-5"><a href="#cb112-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb112-6"><a href="#cb112-6"></a>)</span>
<span id="cb112-7"><a href="#cb112-7"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb112-8"><a href="#cb112-8"></a><span class="kw">lapply</span>(<span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars),rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
</div>
<div id="section-26" class="section level1">
<h1>204.5.4</h1>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb114-2"><a href="#cb114-2"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb114-3"><a href="#cb114-3"></a>  mtcars[rows, ]</span>
<span id="cb114-4"><a href="#cb114-4"></a>})</span>
<span id="cb114-5"><a href="#cb114-5"></a><span class="kw">lapply</span>(<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg <span class="op">~</span><span class="st"> </span>disp),rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6996579
## 
## [[2]]
## [1] 0.691455
## 
## [[3]]
## [1] 0.7163722
## 
## [[4]]
## [1] 0.7300441
## 
## [[5]]
## [1] 0.7376913
## 
## [[6]]
## [1] 0.791123
## 
## [[7]]
## [1] 0.7175499
## 
## [[8]]
## [1] 0.5748613
## 
## [[9]]
## [1] 0.8320519
## 
## [[10]]
## [1] 0.5502131</code></pre>
</div>
<div id="a-2" class="section level1">
<h1>214.1(a)</h1>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">vapply</span>(mtcars,sd,<span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
<div id="b-2" class="section level1">
<h1>214.1(b)</h1>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">y =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>],<span class="dt">z=</span><span class="dv">2</span><span class="op">:</span><span class="dv">11</span>)</span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="kw">vapply</span>(df[,<span class="kw">which</span>(<span class="kw">vapply</span>(df, is.numeric,<span class="kw">logical</span>(<span class="dv">1</span>))<span class="op">==</span><span class="ot">TRUE</span>)],sd,<span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##       x       z 
## 3.02765 3.02765</code></pre>
</div>
<div id="section-27" class="section level1">
<h1>214.7</h1>
<p>No,I can’t</p>
<div id="hw11" class="section level2">
<h2>HW11</h2>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</p>
<ol style="list-style-type: decimal">
<li><p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ol>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
</div>
</div>
<div id="section-28" class="section level1">
<h1>(1)</h1>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>R_Gibbs&lt;-<span class="cf">function</span>(n,a,b){</span>
<span id="cb120-2"><a href="#cb120-2"></a>  N &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#length of chain</span></span>
<span id="cb120-3"><a href="#cb120-3"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb120-4"><a href="#cb120-4"></a>  </span>
<span id="cb120-5"><a href="#cb120-5"></a>  X[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb120-6"><a href="#cb120-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb120-7"><a href="#cb120-7"></a>    x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb120-8"><a href="#cb120-8"></a>    X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb120-9"><a href="#cb120-9"></a>    x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb120-10"><a href="#cb120-10"></a>    X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, x1<span class="op">+</span>a, n<span class="op">-</span>x1<span class="op">+</span>b)</span>
<span id="cb120-11"><a href="#cb120-11"></a>  }</span>
<span id="cb120-12"><a href="#cb120-12"></a></span>
<span id="cb120-13"><a href="#cb120-13"></a>  <span class="kw">return</span>(X)</span>
<span id="cb120-14"><a href="#cb120-14"></a>}</span>
<span id="cb120-15"><a href="#cb120-15"></a></span>
<span id="cb120-16"><a href="#cb120-16"></a></span>
<span id="cb120-17"><a href="#cb120-17"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb120-18"><a href="#cb120-18"></a><span class="kw">cppFunction</span>(<span class="st">&#39;NumericMatrix C_Gibbs(int n,double a, double b){</span></span>
<span id="cb120-19"><a href="#cb120-19"></a><span class="st">            int N=10000;</span></span>
<span id="cb120-20"><a href="#cb120-20"></a><span class="st">            int x;</span></span>
<span id="cb120-21"><a href="#cb120-21"></a><span class="st">            double y;</span></span>
<span id="cb120-22"><a href="#cb120-22"></a><span class="st">            NumericMatrix M(N,2);</span></span>
<span id="cb120-23"><a href="#cb120-23"></a><span class="st">            M(0,0)=1;</span></span>
<span id="cb120-24"><a href="#cb120-24"></a><span class="st">            M(0,1)=0.5;</span></span>
<span id="cb120-25"><a href="#cb120-25"></a><span class="st">            for(int i=1;i&lt;N;i++){</span></span>
<span id="cb120-26"><a href="#cb120-26"></a><span class="st">            y=M(i-1,1);</span></span>
<span id="cb120-27"><a href="#cb120-27"></a><span class="st">            M(i,0)=rbinom(1,n,y)[0];</span></span>
<span id="cb120-28"><a href="#cb120-28"></a><span class="st">            x=M(i,0);</span></span>
<span id="cb120-29"><a href="#cb120-29"></a><span class="st">            M(i,1)=rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb120-30"><a href="#cb120-30"></a><span class="st">            }</span></span>
<span id="cb120-31"><a href="#cb120-31"></a><span class="st">            return(M) ;</span></span>
<span id="cb120-32"><a href="#cb120-32"></a><span class="st">            }&#39;</span>)</span>
<span id="cb120-33"><a href="#cb120-33"></a></span>
<span id="cb120-34"><a href="#cb120-34"></a></span>
<span id="cb120-35"><a href="#cb120-35"></a><span class="kw">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb120-36"><a href="#cb120-36"></a>burn&lt;-<span class="dv">1000</span></span>
<span id="cb120-37"><a href="#cb120-37"></a>N&lt;-<span class="dv">10000</span></span>
<span id="cb120-38"><a href="#cb120-38"></a>GibbsR=<span class="kw">R_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb120-39"><a href="#cb120-39"></a>GibbsR&lt;-GibbsR[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N,]</span>
<span id="cb120-40"><a href="#cb120-40"></a>GibbsC=<span class="kw">C_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb120-41"><a href="#cb120-41"></a>GibbsC&lt;-GibbsC[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N,]</span>
<span id="cb120-42"><a href="#cb120-42"></a>GibbsR_x&lt;-GibbsR[,<span class="dv">1</span>]</span>
<span id="cb120-43"><a href="#cb120-43"></a>GibbsR_y&lt;-GibbsR[,<span class="dv">2</span>]</span>
<span id="cb120-44"><a href="#cb120-44"></a></span>
<span id="cb120-45"><a href="#cb120-45"></a>GibbsC_x&lt;-GibbsC[,<span class="dv">1</span>]</span>
<span id="cb120-46"><a href="#cb120-46"></a>GibbsC_y&lt;-GibbsC[,<span class="dv">2</span>]</span>
<span id="cb120-47"><a href="#cb120-47"></a></span>
<span id="cb120-48"><a href="#cb120-48"></a><span class="kw">qqplot</span>(GibbsR_x,GibbsC_x)</span>
<span id="cb120-49"><a href="#cb120-49"></a><span class="kw">qqplot</span>(GibbsR_y,GibbsC_y)</span></code></pre></div>
</div>
<div id="section-29" class="section level1">
<h1>(2)</h1>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb121-2"><a href="#cb121-2"></a>timee&lt;-<span class="kw">microbenchmark</span>(<span class="dt">GibbsR=</span><span class="kw">R_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">GibbsC=</span><span class="kw">C_Gibbs</span>(<span class="dv">15</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="kw">summary</span>(timee)[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
</div>
<div id="section-30" class="section level1">
<h1>(3)</h1>
<p>就是说C快呗.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
